2013-10-27  Ethan A Merritt  <merritt@u.washington.edu>

	* src/misc.c(lp_parse): Fix bug involving color assignment to contours.
	Unfortunately this negates a previous fix that allowed explicit surface
	colors in a hidden3d plot to implicitly do "set hidden3d offset 0".

2013-10-26  Thomas Bleher <tbleher@gmx.de>

	* src/qtterminal/qt_term.cpp:  Change the Qt terminal to only create its
	data when initialized (to avoid the Static Initialization Order Fiasco)
	and to destroy its data in a gnuplot atexit handler.

2013-10-25  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c (df_readascii df_readmatrix):  If the first field of a
	tab-separated csv file was empty, it would be incorrectly ignored when
	processing that input line.
	Bugfix. 

	* src/wxterminal/wxt_gui.cpp:  Extend toggling active region in key box
	to include enhanced text as well as non-enhanced text.
	Bugfix. 

2013-10-25  Thomas Bleher <tbleher@gmx.de>

	* src/stdfn.c(gp_atexit gp_exit) src/stdfn.h src/command.c(exit_command)
	src/plot.c(main) src/qtterminal/qt_term.cpp src/win/winmain.c
	src/wxterminal/gp_cairo.c src/wxterminal/gp_cairo_helpers.c
	src/wxterminal/wxt_gui.cpp term/be.trm term/x11.trm:

	Create gnuplot atexit handlers that are called before exit(3)
	
	Normal atexit-handlers are called in the reverse order of registration.
	This causes problems when a library has its own global destructors which
	do not handle the case that objects of the library may still be active
	and destroyed in the atexit handler. This has been observed with Qt.
	
	Introduce a new function gp_exit() which calls the gnuplot atexit handlers
	and then calls exit(3). Also create gp_atexit() to register gnuplot exit
	handlers.

	* src/getcolor.c (quantize_gray):  Windows compile error ("small" is not
	accepted as a variable name).

	* config/msvc/Makefile:  DEBUG option when compiling with MSVC

2013-10-25  Ethan A Merritt  <merritt@u.washington.edu>

	* src/corgraph.asm  src/hrcgraph.asm  src/pcgraph.asm src/corplot.c:
	Remove vestigial files from the era of 16-bit DOS.	

	* configure.in term/unixpc.trm src/term.c src/term.h src/syscfg.h
	src/makefile.all src/makefile.awc config/makefile.* docs/doc2texi.el:
	Remove vestigial driver and makefile entries for the AT&T 3b1 "unix pc".
	Early M6800-based tiny (256Kb) machine.

2013-10-23  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot.c (main):  If commands are being executed interactively
	because the user said something like "gnuplot -", then execution should
	continue after an error message just as in a normal interactive session.
	Bug #1295

	* src/mouse.c (event_reset) src/term.c (check_for_mouse_events):  
	Must not send commands to the terminal if it has not yet been
	initialized.

	* term/gd.trm src/wxterminal/gp_cairo.c:
	Inboard terminal drivers should not write errors to stdout and normally
	should not call exit() themselves.

2013-10-21  Ethan A Merritt  <merritt@u.washington.edu>

	* src/color.h src/set.c src/getcolor.c (quantize_gray):
	Change the algorithm used to assign palette colors in the case
	   set palette defined (...) maxcolors N
	where the gradient boundaries are unevenly spaced. Previous versions
	of quantize_gray() have shown a variety of bad outcomes.  This version
	has fewer, less ugly, bad outcomes but it is still sensitive to the
	choice of maxcolors.  Try changing maxcolors by +/- one if the generated
	palette is bad.
	Bug #1140 and others

	* src/command.c (test_palette_subcommand):  The "test palette" command
	does not need to zero the current input line, and hasn't needed to since
	lf_push/lf_pop were introduced 5 years ago.

2013-10-18  Christoph Bersch <usenet@bersch.net>

	* src/gadgets.h  src/graphics.c  src/graphics.h src/save.c src/set.c 
	demo/all.dem demo/clipobject.dem docs/gnuplot.doc:
	New object attribute clip/noclip.  "clip" retains the current default,
	clip to plot boundary unless one or more vertices are given in screen
	coordinates.  "noclip" clips to the canvas.

2013-10-18  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/gnuplot-ja.doc term-ja.diff:  Sync translation to version 1.830

2013-10-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c (place_objects):  Make clipping of various objects
	more consistent.  Clip to graph unless the center or some vertex is
	specified in screen coordinates.

	* src/save.c (save_object):  "show object N" was incorrectly printing
	lines for other objects as well.

2013-10-13  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c: DEFAULT_GRID_LP

	* src/plot2d.c: Issue warning if "smooth" option causes columns in the
	using spec to be ignored.

	* src/axis.c (gen_tics): Suppress log-scaled mtics and minor grid lines 
	that would lie on top of the major tic/grid.
	Bug #1292

	* src/pm3d.c: Allow "set pm3d top/bottom" and "set pm3d interpolate N,M"
	to be active at the same time.

	* src/unset.c (reset_key): Don't leak memory when resetting key title.

2013-10-11  Craig DeForest  <deforest@boulder.swri.edu>

	* src/wxterminal/wxt_gui.cpp (wxt_waitforinput):
	Handle TERM_ONLY_CHECK_MOUSING in the single-threaded code path.
	Bug #1293

2013-10-11  Ethan A Merritt  <merritt@u.washington.edu>

	* src/wxterminal/wxt_gui.cpp (wxt_waitforinput):  One code path followed
	in the case of piped input to a script with mousing enabled failed to 
	test for the new TERM_ONLY_CHECK_MOUSING flag.
	Bug #1293

2013-10-09  Ethan A Merritt  <merritt@u.washington.edu>

	* src/util.c (gprintf) axis.h: (REVERTED)

2013-10-06  Ethan A Merritt  <merritt@u.washington.edu>

	* term/aquaterm.trm term/cairo.trm term/canvas.trm term/emf.trm
	term/gd.trm term/pdf.trm term/post.trm term/svg.trm term/win.trm
	term/wxt.trm term/x11.trm term/qt.trm src/qtterminal/qt_term.cpp:

	Default to enhanced text mode in terminals that support it.
	This mode can still be disabled by "set term FOO noenhenced" or
	"set termoption noenhanced".

2013-10-06  Craig DeForest  <deforest@boulder.swri.edu>

	* src/axis.h src/util.c (gprintf) docs/gnuplot.doc:
	New format specifier %h expands to the same as %g except that the
	exponential term, if any, is written using enhanced text or LaTeX markup
	to generate "x10^{foo}" rather than "E+foo". The default format for axis
	tics is now "% h" ("$%h$" for LaTeX terminals).

2013-10-02  Ethan A Merritt  <merritt@u.washington.edu>

        * src/command.c (expand_1level_macros):  Never try to expand an 
	undefined variable as a macro.

2013-10-02  Ethan A Merritt  <merritt@u.washington.edu>

        * src/graphics.c (plot_steps plot_fsteps plot_histeps):
	Replace 350 lines of ad hoc clipping with calls to draw_clip_line.

	* src/gadgets.c src/gadgets.h:  There are no longer any external callers
	of clip_line(), so make it local to gadgets.

2013-10-01  Christoph Bersch <usenet@bersch.net>

	* src/plot2d.c (store_label):  Plots with labels should accept variable
	color both for the label text and for the associated point symbol.
        Bug #1281

2013-09-30  Ethan A Merritt  <merritt@u.washington.edu>

        * src/graphics.c (plot_bars):  Draw error bars using draw_clip_line
	rather than performing ad hoc clipping on the spot.
	Bug #1289

2013-09-26  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c src/axis.h src/save.c src/set.c src/stdfn.h src/unset.c:
	Consolidate axis range flags from two fields into a single field.

	* src/axis.c src/axis.h src/boundary.c src/gadgets.c src/gadgets.h
	src/graph3d.c src/graphics.c src/hidden3d.c src/misc.c src/plot2d.c
	src/plot3d.c src/pm3d.c src/save.c src/set.c src/show.c src/term_api.h
	src/term.c src/util3d.c src/color.c:

	Simplify the historical redundancy of color properties stored in struct
	lp_style_type by removing the TBOOLEAN use_palette. FALSE meant generate
	color from l_type; TRUE meant take color from t_colorspec pm3d_color.
	Now we always use the t_colorspec.  This means that l_type refers only
	to the dot/dash pattern, not color, so it becomes easier to map it to a
	user-visible property "dashtype" in the future.  It also has the side
	effect of creating a single decision point in apply_pm3dcolor() where
	[almost] all color commands are filtered against the current terminal 
	setting monochrome/color.  Before this, colors could slip erroneously
	into a "monochrome" plot.  Now we limit this to an explicit set of
	conditions, currently plots with rgbimage, rgb variable, or certain
	user-defined color palettes.  That 3rd category is a bit loose and may
	need to be more carefully defined.

	* src/axis.c src/axis.h src/set.c src/unset.c:
	Dynamically allocate axis->formatstring and axis->timefmt.

2013-09-25  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.h src/plot3d.c:  plot3d.c is the only user of NEED_PALETTE,
	so move it there.

	* src/color.c (set_rgbcolor_var set_rgbcolor_const) src/color.h
	src/pm3d.c src/hidden3d.c src/graphics.c src/graph3d.c:
	Provide two parallel routines for passing RGB color information to a
	terminal. set_rgbcolor_const sets the color immediately.
	set_rgbcolor_var flags that this came from a plot with "rgb variable"
	and passes it to apply_pm3dcolor for possible additional filtering
	(e.g. decide whether to pass it to a monochrome terminal or not).

2013-09-23  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c (null_set_color) src/term_api.h (TERM_NULL_SET_COLOR)
	src/boundary.c src/color.c src/gadgets.c src/graph3d.c src/graphics.c:
	Provide a null_set_color() routine to cover all terminals that do not
	provide their own term->set_color() routine.  This removes the need to
	check for term->set_color before trying to call it.  It also makes the
	behavior of non-RGB terminals more consistent, although still imperfect.

	* src/graph3d.c src/boundary.c:  Don't try to use opaque (background)
	fill if the terminal does not support RGB colors.

	* src/graph3d.c: Always color contour lines via set_color, even for
	terminals that do not support RGB colors.
	Bug #1284

	* src/command.c src/graph3d.c: Set can_pm3d based on TERM_NULL_SET_COLOR

2013-09-20  Per Persson  <persquare@users.sourceforge.net>

	* configure.in m4/apple.m4 src/term.c src/term.h:
	Modify configuration tests to look for aquaterm as a framework rather
	than as a library.

2013-09-20  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gadgets.h: Initialize histogram_opts to HT_CLUSTERED.
	Bug #1285

	* src/graphics.c (place_grid):  Must initialize tic_direction when
	drawing r-axis tics.  Otherwise we get whatever the last set of 
	x or y tics used, or if they have not been used then nothing at all.
	Bug #1286

	* src/boundary.c (draw_key) src/graph3d.c (do_3dplot):
	If the terminal doesn't support term->set_color() then we can't
	background-fill an opaque key box.

2013-09-17  Ethan A Merritt  <merritt@u.washington.edu>

	* term/emf.trm (EMF_point): filled circles (pointtype 7) were
	incorrectly being drawn with a black border.

	* src/plot2d.c (polar_range_fiddling):  In a polar mode plot, if x, y,
	and r are all auto-scaled then prefer a symmetric plot centered at the
	orgin with radius rmax over an asymmetric plot produced by treating the
	data ranges on x and y independently.

	* src/util.c (equals almost_equals):  Additional sanity checking of
	c_token on entry.

2013-09-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/internal.c (f_push) src/parse.c src/parse.h src/command.c:
	The routine try_to_get_string() was intended to safely return FALSE if
	the current syntax cannot be evaluated as a string.  But f_push()
	triggered a fatal error if an unrecognized token was encountered during
	evaluation.  Now it quietly returns NaN and try_to_get_string() returns
	FALSE.

	* src/misc.c (prepare_call):  When parsing arguments to "call", treat
	the next bit of the input line as a string if at all possible.  This
	includes taking the contents of a string variable or evaluating the
	result of a string expression.  Only fall back to wrapping each token
	in quotes if this fails.  This is a CHANGE made in preparation for a
	re-implementation of the `call` command argument passing mechanism.

2013-09-12  Ethan A Merritt  <merritt@u.washington.edu>

	* src/eval.c (clear_udf_list) src/eval.h src/unset.c:  Provide a routine
	that deletes all currently defined user functions. This is invoked as
	part of "reset session".

	* src/plot.c (init_constants) src/plot.h src/unset.c:  "reset session"
	reinitializes variables NaN and pi since bad user code can clobber them.

2013-09-11  Christoph Bersch <usenet@bersch.net>

	* src/set.c src/unset.c: Sanity check "set style increment foo" command,
	reset to default on "reset" command.
	Bug #1282

2013-09-09  Ethan A Merritt  <merritt@u.washington.edu>

	* term/cairo.trm (cairopng_write_cropped_image): Must free cropped image
	and the structure that holds it, otherwise there is a memory leak.
	Bug #1278

	* axis.h (TIC_SCALE):  tics generated from data (e.g. xticlabels(COL))
	get same size tic marks as major tics.
	Bug #1280

	* pm3d.c (set_plot_with_palette): "tc variable" was incorrectly causing
	the color bar to be drawn by default.

	* graphics.c (check_for_variable_color): "lc variable" should index the
	line _type_ (not _style_) colors unless "set style increment user".
	Bug #1281

	* plot2d.c (store_label):  Same fix for "with labels tc variable".
	Bug #1281

2013-09-08  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c src/misc.c src/misc.h src/plot.c:  Clean up code,
	remove unused variables, add comments, new parameter to load_file(),
	all in preparation for a revision to the "call" mechanism.

	* src/scanner.c (scanner):  The syntactic entity $# (number of arguments
	in a call statment) has been mishandled as introducing a comment since
	sometime in version 4.5.  Trap it as a special case in the scanner.

	* src/misc.c src/plot.c:  New command line option 
	"gnuplot -c scriptfile ARG1 ARG2 ... " executes scriptfile using 
	"call" rather "load" and passes arguments ARG1 ARG2 etc.  
	This patch leaves the old call argument convention in place
	$0 = ARG1,  $1 = ARG2, etc, $# = number of arguments
	but a future patch series will introduce a more C-like convention
	for the arguments.  Modified from an original patch by Shige Takeno.

2013-09-07  Ethan A Merritt  <merritt@u.washington.edu>

	* src/color.c src/color.h src/eval.c src/eval.h src/plot.c src/plot.h
	src/set.c src/show.c src/unset.c docs/gnuplot.doc:

	- Consolidate code called on program entry and during "reset".
	- Group program-defined variables (pi, NaN, GNUTERM) at the start of the
	  udv list and protect them from deletion.
	- New command "reset session" does a reset followed by loading gnuplotrc
	  and ~/.gnuplot.  It also deletes (actually undefines) all user-defined
	  variables. This puts the program in approximately the same state as it
	  was on first entry.
	- Fixes memory leak; palette functions were reset without being freed.

2013-09-01  Peter Juhasz  <juhaszp@users.sourceforge.net>

	* src/mouse.h src/mouse.c src/unset.c (reset_command):
	'reset' command restores default mouse settings, warns on bogus 
	options, no longer accepts 'x' or similar axis options

2013-08-28  Christoph Bersch <usenet@bersch.net>

	* src/save.c (save_set_all): Emit a "unset object" command before
	saving objects.  Bug #1251

2013-08-28  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c src/graphics.h src/plot2d.c src/save.c src/save.h
	src/set.c src/show.c src/unset.c docs/gnuplot.doc demo/histograms2.dem:
	Accept an explicit title font and text color in "set style histogram"
	and "newhistogram" commands.

2013-08-26  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c src/term_api.h term/x11.trm
	src/qtterminal//qt_term.cpp src/wxterminal//wxt_gui.cpp:
	Peter Juhasz's game demos show that the 1 msec timeout in 
	term->waitforinput(TERM_ONLY_CHECK_MOUSING) may be a mistake.
	This patch #defines it as TERM_EVENT_POLL_TIMEOUT in term_api.h
	and sets it to 0 by default.

2013-08-25  Ethan A Merritt  <merritt@u.washington.edu>

	* term/x11.trm (x11_waitforinput) term/xlib.trm:   Handle the case of
	input from a file, output to x11, and TERM_ONLY_CHECK_MOUSING.
	xlib output should never expect mouse events.

2013-08-24  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gplt_x11.c term/x11.trm:  Use more precision when writing out
	the axis dimensions and scale at the end of a plot.  This prevents
	rounding errors in the mouse coordinates reported in -persist mode.
	Bug #1276

2013-08-23  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c src/qtterminal/qt_term.cpp src/qtterminal/qt_term.h
	src/readline.c src/term_api.h src/term.c src/wxterminal/wxt_gui.cpp
	src/wxterminal/wxt_term.h term/ggi.trm term/win.trm term/x11.trm
	term/README:

	Gnuplot handles mouse events and hotkeys by multiplexing them with
	terminal input via the interface term->waitforinput(). That means no
	events are handled if the program is not waiting for terminal input,
	as in "load", "pause <time>", "eval" or other such commands.
	Now we add an option term->waitforinput(TERM_ONLY_CHECK_MOUSING)
	that handles mouse events but does not block waiting for terminal
	input, and a wrapper routine check_for_mouse_events() that can be
	called during "load", "pause", etc. However this patch does not yet
	add such calls, so there should not yet be any change in behavior.

	* src/command.c (do_line timed_pause):
	This patch adds a call to check_for_mouse_events() in two places.
	The call in do_line() is invoked once for each line processed by
	load/eval/while and other commands.  The timed_pause() routine polls
	for events 20 times per second while counting down the time given in a
	"pause <time>" command.

	* term/vgagl.trm term/ggi.trm 
	src/mouse.c (UpdateStatuslineWithMouseSetting):
	The ^C interrupt handling code sets term_initialised to FALSE.
	The mousing update code was interpreting this as meaning that no mouse
	updates were possible.  This patch adds internal checks to the only two
	drivers that might have a problem and removes the global suppression of
	mouse coordinate updates after an interrupt.

2013-08-23  Petr Mikulik  <mikulik@physics.muni.cz>

	* src/term.c (test_term): "test" was not respecting "set origin".

2013-08-20  Kyle <elconquistador@users.sourceforge.net>

	* src/fit.c (regress): The value of chisq was corrupted in the process
	of scaling the parameter errors.  This isn't a problem by itself, but a
	patch applied in April 2013 introduced a call to show_results() that
	passed in the corrupted value.
	Bug #1275

2013-08-20  Ethan A Merritt  <merritt@u.washington.edu>

	* src/set.c src/tables.c src/tables.h src/unset.c src/axis.c src/show.c
	src/save.c docs/gnuplot.doc:  Support minor tics on polar axis.

2013-08-20  Jon Gjengset <jon@thesquareplanet.com>

	* src/term_api.h src/gplt_x11.c src/mouse.c term/x11.trm term/qt.trm
	term/wxt.trm term/README src/wxterminal/wxt_gui.cpp
	src/wxterminal/wxt_term.h src/qtterminal/QtGnuplotEvent.h
	src/qtterminal/QtGnuplotScene.cpp src/qtterminal/qt_term.cpp
	src/qtterminal/qt_term.h:
	Add term->modify_plots() interface (and implementations for wxt, qt and
	x11) for applying operations to every plot in a graph. Current use cases
	include hiding and showing all plots and inverting plot visibility.
	Useful in situations where many sets of data are plotted initially, but
	the user only wishes to focus on a few.

2013-08-19  Ethan A Merritt  <merritt@u.washington.edu>

	* src/win/wgraph.c:  Must honor TERM_LAYER_RESET.

	* term/x11.trm (X11_layer):  ignore TERM_LAYER_RESET in multiplot.

	* src/term.c (term_start_multiplot):  Several terminals (qt, wxt, x11)
	ignore TERM_LAYER_RESET during multiplot.  Thus in order to correctly 
	initialize the plot structures, the reset must happen before the
	multiplot flag is set.  Without this change, mouse toggle of 
	multiplots can trigger an access violation.  Bug fix.

2013-08-16  Allin Cottrell  <cottrell@wfu.edu>

	* src/internal.c (GP_MATHERR): 1st part of win64 compatibility patch.
	The matherr() mechanism is not used by win64. It's also not used by
	current linux but it doesn't hurt to leave it in place for now.

	* src/win/wprinter.c src/win/winmain.c src/win/wtext.c src/win/wmenu.c
	src/win/wpause.c src/win/wgraph.c:
	2nd part of win64 compatability patch.  All changes are #ifdef _WIN64.

	src/win/wgnuplot.rc src/win/wgnuplot.exe.manifest64:
	The file win/wgnuplot.exe.manifest specifies the processorArchitecture
	as "X86". For an x86_64 build this must be changed to "amd64"
	(or wgnuplot.exe won't start). The manifest file is included by
	win/wgnuplot.rc. The modified wgnuplot.rc includes an alternative file
	wgnuplot.exe.manifest64 if the symbol _WIN64 is defined. This file 
	simply substitutes "amd64" for "X86" in two places.

2013-08-13  Ethan A Merritt  <merritt@u.washington.edu>

	* src/eval.c (update_gpval_variables):  Missing GPVAL_* entry
	for R_AXIS.max.

2013-08-12  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/Makefile.maint (version, patchlevel, last_change)
	(makefile.all, version.c): Prepare for possible use out-of-tree.

	* src/Makefile.am (timestamp.h): New rule for timestamp.h that
	cooperates with automake that should work for non-GNU make and
	out-of-tree builds.
	(BUILT_SOURCES): Add timestamp.h to be built before anything else.

	* src/Makefile.maint: timestamp.h rule removed again.

	* src/.cvsignore: Ignore timestamp.h and *.o files.

	* src/version.c [DEVELOPMENT_VERSION]: Include new timestamp.h
	instead of using fixed time stamp.

	* src/Makefile.maint (version.c): Remove timestamp update
	mechanism.
	(timestamp.h): Create new, separate header file that only holds
	the current timestamp.

2013-08-09  Mojca Miklavec  <mojca.miklavec.lists@gmail.com>

	* configure.in:  Change configuration option from --with-wx-config=PATH
	to --with-wx=DIR.  The is more consistent both with other gnuplot
	configuration options and with the upstream documentation for wx.

2013-08-09  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in src/command.c src/command.h src/save.c src/set.c
	src/show.c src/tables.c src/unset.c demo/macros.dem:
	Remove configuration option for command line macros.
	It's cheap. People use it. It doesn't conflict with anything else.
	There seems little reason to carry along extra code to disable it.

2013-08-09  Christoph Bersch <usenet@bersch.net>

	* src/gadgets.c src/misc.c src/save.c src/term_api.h src/term.c:
	New arrow style option "fixed" disables the re-sizing of arrow heads
	for short arrows.

2013-08-08  Christoph Bersch <usenet@bersch.net>

	* src/gadgets.c (draw_clip_polygon):  Sometimes the clipping status of
	the current point and the line segment it is supposedly the end of do
	not match.  This probably indicates a bug somewhere else, but in any
	case we need to adjust the clipping to match the line segment.
	Bug #1268

 	* src/gadgets.c src/misc.c src/save.c src/set.c src/show.c src/term.c
	src/term_api.h:  New arrow style option "noborder" requests a filled 
	arrowhead with no line drawn around the outside.  This has the effect
	of guaranteeing that the tip of the arrow head is exactly on the
	coordinate of the end of the vector;  otherwise the linewidth of the
	border causes the tip to extend beyond this coordinate.
	Bug #1109

 	* demo/arrowstyle.dem docs/gnuplot.doc:  Document and illustrate.

2013-08-08  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c:  Add comment noting that axis_position_zeroaxis() must
	be called for each axis before plotting in order to set axis->term_zero.

	* src/graphics.c:  It is incorrect to skip the initial calls to
	axis_draw_2d_zeroaxis even if we know the zero axes will be drawn
	again later (e.g. grid is off or front).
	Bug #1267

	* src/datafile.c:  Fix segfault if we try to store strlen of a NULL
	column header string.

2013-08-06  Ethan A Merritt  <merritt@u.washington.edu>

	* src/eval.c (pop_or_convert_from_string):  Context-dependent 
	conversion of a string containing a number to an actual number is
	documented as evaluating to either an integer or a complex variable as
	appropriate.  However up to now it has always produced a complex in
	practice.  Now we really do evaluate to an integer if the string
	contains only digits and whitespace.
	Bug #1269

	* src/datafile.c:  Generalize the substitution of columnheaders into
	a string during evaluation of 'using' or 'title' in a plot command.
	This allows inclusion of more than one columnheader into a single
	resulting string.
	Bug #1271

	* src/gadgets.c:  The annoying crypto-definition of RCSid() at the
	top of the file has been wrong since 2000!?

2013-07-25  Ethan A Merritt  <merritt@u.washington.edu>

	* term/pslatex.trm:  Make the definition of \gptboxtext and friends 
	conditional on their not being defined already.  This prevents latex
	from complaining if multiple gnuplot graphs are included in the same
	*.tex document.  Another possibility would be to move the definition
	into gnuplot.cfg.
	Bug #1266

2013-07-22  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.h src/command.c (string_expand_macros do_line)
	src/misc.c (load_file):  Under some conditions, e.g. inside a multi-line
	clause in curly brackets, the input command line can be extended after
	it has already been checked for the presence of macros.  This caused any
	macros in the new part of the input line to be unrecognized.
	Now we recheck for macros whenever the input line is extended.
	Bug #1264

2013-07-18  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in:  Allow for the case that pkg-config is needed in order
	to find libcerf (which Mojca Miklavec reports is the case on OSX).

	* term/svg.trm:  The svg terminal should not rely on 'set fontpath',
	which was written and documented to apply only to the postscript
	terminal.

2013-07-15  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/makefile.all src/makefile.awc:  Recreate to include libcerf.

	* demo/cerf.dem:  UTF8 encoding

	* docs/gnuplot.doc:  HTML table for libcerf functions.

	* config/mingw/Makefile:  Build option to use libcerf.

2013-07-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/show.c (show_version):  Report +LIBCERF in 'show version long'.

	* demo/cerf.dem:  Exercise functions imported from libcerf, if present.

2013-07-12  Ethan A Merritt  <merritt@u.washington.edu>

	* src/specfun.c (f_airy):  The implementation of the Airy function 
	used in 4.6 has poor precision (up to 2% relative error).  Replace it
	with code from the Cephes library, the source of other routines
	already in specfun.c.

	*  configure.in docs/gnuplot.doc src/Makefile.am src/eval.c
	src/libcerf.c src/libcerf.h src/specfun.c src/specfun.h:

	The MIT-licensed libcerf library provides a set of special functions
	related to the complex error function cerf(z).  If it is found during
	./configure, we compile user-callable wrappers for the routines
	Complex error function
		   cerf(z) = 2/sqrt(pi) * int[0,z] exp(-t^2) dt
	Complex Dawson's Integral
		   cdawson(z) = exp(-z^2) int[0,z] exp(t^2) dt
		              = sqrt(pi)/2 * exp(-z^2) * erfi(z)
	Imaginary error function (real valued)
		   erfi(x) = -i * erf(i * x)
	Faddeeva rescaled complex error function (Abramowitz & Stegun 7.1.3)
		   faddeeva(z) = w(z) = exp(-z^2) * erfc(-i*z)
	Voigt Profile 
		   VP(x, sigma, gamma) = integral G(t;sigma) L(x-t;gamma) dt
		corresponding to convolution of
		Gaussian 
		   G(x;sigma) = 1/sqrt(2*pi)/|sigma| * exp(-x^2/2/sigma^2)
		with Lorentzian
		   L(x;gamma) = |gamma| / pi / ( x^2 + gamma^2 )
	The libcerf routine re_w_of_z(x,y) is used to provide a higher accuracy
	version of voigt(x,y).

2013-07-06  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wgraph.c (luma_from_color):  New function.

	* src/win/wgraph.c:  Avoid unnecessary tracking of text size for
	non-boxed text.

	* src/win/wtext.c:  Accept Ctrl-C to copy to clipboard.  Fix index out
	of range error if text selection extends beyond the end of line.

	* config/cygwin/Makefile config/msvc/Makefile config/mingw/Makefile
	config/watcom/Makefile win/gnuplot.iss:  All Windows binaries now 
	support some sort of pipes.  Consequently remove pgnuplot from 
	default build and installation.

2013-07-05  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* term/tgif.trm:  Reduce the point size by 50% to match other terminals.
	Use the generic do_arrow() routine.

2013-07-05  Dima Kogan  <dima@secretsauce.net>

	* configure.in:  Test for incomplete installation of wxWidgets
	development environment.

2013-07-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gadgets.c src/term_api.h term/cairo.trm term/pslatex.trm:
	Boxed text support for epslatex and cairolatex terminals.

	* docs/Makefile.am:  --without-lisp-files should also control whether
	or not gnuplot-eldoc.el and gnuplot-eldoc.elc are installed.

2013-07-04  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/README.ja docs/term-ja.diff:  Update Japanese help texts.

2013-07-03  Ethan A Merritt  <merritt@u.washington.edu>

	* src/time.c (gstrptime): Beware of time in seconds specified as an
	exponential; e.g. 123.456e7 seconds does not end in 456 usec.

	* src/graph3d.c: Better fix for	Bug #1252, inverted parallel axis labels

2013-07-02  Mojca Miklavec  <mojca.miklavec.lists@gmail.com>

	* src/command.c src/plot.c src/plot.h src/variable.c:
	Remove obsolete instances of #ifdef (_Macintosh)

2013-07-02  Ulrich Müller  <ulimueller@users.sf.net>

	* docs/doc2texi.el:  Provide a substitute for the lisp routine
	replace-regexp-in-string, which is missing in xemacs prior to version
	25.1.something.

	* docs/Makefile.am:  Modify build commands for gnuplot.texi so that
	xemacs and newer emacs (25.1) are happy.

	* docs/doc2texi.el:  Map terminal HELP sections to level 3 (subsection)
	and level 4 (subsubsection) rather than levels 4 and 5.
	Bug #1226

2013-07-02  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/gnuplot-ja.doc:  Sync translation to version 1.810
	* docs/gnuplot.doc:  Fix typos.
	Correct the documentation for the order of elements in a binary matrix
	or ascii nonuniform matrix.
	Bug #1248

2013-07-01  Ethan A Merritt  <merritt@u.washington.edu>

	* src/Makefile.am:  Drop original PC assembly files from the source
	tarball (corgraph.asm header.mac hrcgraph.asm pcgraph.asm lineproc.mac)

	* src/hidden3d.c src/contour.c src/gplt_x11.c src/qtterminal/qt_term.cpp
	term/cairo.trm:  Reduce the number of annoying compiler warnings.

	* src/datafile.c (plot_ticlabel_using):  Explicit error message if
	required parentheses are missing from using spec.
	Bug #1256

	* src/command.c (print_command): Print \n after each line of a datablock

	* src/time.c (gstrptime): Pass through fractional seconds read with
	time format "%s".

2013-06-30  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c src/axis.h src/set.c src/unset.c src/show.c src/save.c
	docs/gnuplot.doc:  Extend "set tics scale" to control the size of tics
	at levels 2 and above.

2013-06-29  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c (draw3d_graphbox):  "set [xy]label rotate parallel"
	is affected by the direction of the complementary axis.
	Bug #1252

2013-06-29  Peter Juhasz  <juhaszp@users.sourceforge.net>

	* src/axis.h src/axis.c src/graphics.c src/graph3d.c src/color.c 
	doc/gnuplot.doc:
	Allow minor tic levels 2 or higher to have labels. 

2013-06-28  Ethan A Merritt  <merritt@u.washington.edu>

	* src/misc.c (load_file): Expand macros up to 3 levels deep when 
	stepping through a "load" operation.  This matches the depth allowed
	for use at the top level command line.
	Bug #1246

2013-06-28  Christoph Bersch <usenet@bersch.net>

	* src/gadgets.c(clip_polygon): Use a temporary copy of the input 
	vertices rather than overwriting them during clipping.
	Bug #1255

2013-06-28  Jérôme Lodewyck  <lodewyck@users.sourceforge.net>

	* src/qtterminal/QtGnuplotScene.cpp:  Fixed the text transformation
	origin.

2013-06-27  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c src/hidden3d.c src/hidden3d.h demo/contours.dem:
	Apply hidden3d processing to contour labels.

	* src/datafile.h src/fit.c src/show.c demo/fitmulti.dem
	docs/gnuplot.doc:  Increase the number of independent parameters
	(dimensions) handled by "fit" from 5 to MAX_NUM_VAR, which is currently
	12.  MAXDATACOLS is correspondingly increased to MAX_NUM_VAR+2 = 14.
	NB: Only the first 2 dimensions, "x" and "y" by default, use the axis
	structures.  So calling 'set xrange' or 'set yrange' can affect the
	fit by limiting the range of coordinates that are accepted, just as
	with previous versions.  However, there is no connection between
	independent parameters 3, 4, ... and any axis ranges or structures.
	Therefore time data can be given for the first and second dimensions
	but not for any additional dimensions.

2013-06-24  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c: Bug fix for contour line colors. If the base linetypes
	have no color assigned (i.e. "set linetype" has never been done), then
	we must explicitly set use_palette in order to generate color from the
	line type.  Since the hidden3d code currently uses the linetype itself
	rather than the value in TC_LT, we set a new linetype also
	(bug fix from Don Tabor).

2013-06-24  Bastian Maerkisch  <bmaerkisch@web.de>

	* config/makefile.cyg config/cygwin/Makefile config/mingw/Makefile
	config/msvc/Makefile config/watcom/Makefile:  Define WINDOWS_NO_GUI
	when building text mode tools instead of undefining _Windows.

2013-06-23  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/syscfg.h src/win/wgraph.c src/win/winmain.c src/win/wmenu.c
	src/win/wtext.c:  Move definition of flags for windows.h.  Minimal
	required platform is still Windows XP.

	* src/fit.c (is_empty, get_next_word):  Accept '\r' as end-of-line
	character of parameter files.  Necessary since files are now always
	opened in binary mode on Windows, see change on 2013-06-02.

2013-06-22  Mojca Miklavec  <mojca.miklavec.lists@gmail.com>

	* term/context.trm: Explicitly disable color in standalone ConTeXt
	documents when monochrome option is chosen.

2013-06-19  Ethan A Merritt  <merritt@u.washington.edu>

	* src/boundary.c src/gadgets.h src/graph3d.c src/set.c src/show.c
	src/unset.c src/tables.c src/tables.h:  Dynamic allocation of key title.
	Deprecate undocumented commands "set|show|unset keytitle".
	Redirect "set keytitle foo" to "set key title foo".

2013-06-18  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* src/datafile.c (plot_option_every):  Treat negative numbers as
	indicating "default value".

2013-06-16  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gplt_x11.c:  Replace call to deprecated XKeycodeToKeysym with a
	call to XkbKeycodeToKeysym.  This introduces a dependence on the XKB
	extension but it's not clear there is any alternative.

2013-06-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/fit.c:  Use dummy variable names from `set dummy` in preference
	to the default sequence x y t u v z.
	Do not ask df_readline() to process more columns than necessary.

	* src/datafile.c:  Replace an assertion (MAXDATACOLS == 7) with the
	specifically relevant test (<number of requested format terms> <= 7).
	I.e. the limit is due to applying a fixed format statement to the 
	current request for data, not from a cap on the number of columns
	that might hypothetically be requested.  Similarly replace assertion
	(max_using <= MAXDATACOLS) with a check for whether the limit is
	actually exceeded by the current using spec.

	* demo/fitmulti.dem:  Include a test script written by Hanno Hoffstadt
	that exercises multidimensional fitting.  The fit routine currently
	handles up to 5 independent dimensions, but the script tries up to six.
	It incidentally exercises the `set dummy` command and `while {...}`.

	* src/show.c (show_fit):  Report previous 'fit' command.

	* src/datafile.c (df_tokenise):  Get rid of erroneous test against
	axis_array[foo].timefmt (always evaluates as TRUE).

2013-06-12  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in:  More complete autoconfigure tests for qt5.

	* src/save.c (save_dummy) src/set.c (set_dummy) src/show.c
	src/unset.c (unset_dumm) docs/gnuplot.doc demo/fit.dem:
	"fit" can use more dummy variable names than plot or splot, but these
	were not being shown/reset/saved.  Document "unset dummy".
	Now we handle the full set of possible dummy variables (MAX_NUM_VAR).

2013-06-11  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wgnuplib.h src/win/wgraph.c term/win.trm:  Support boxed
	labels.  Includes support for rotated text.

	* src/win/wgdiplus.cpp (gdiplusPolylineEx):  Properly close polygons
	by using DrawPolygon if the first and last point of the polyline are
	equal.

	* src/win/wgraph.c:  Tweak layer support.

2013-06-10  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* src/show.c src/unset.c:  show/unset individual datafile options.

	* docs/gnuplot.doc src/specfun.c:  Documentation shows incorrect sign
	in the exponent of the Voigt function.  

	* docs/gnuplot.doc: typos

2013-06-06  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/fit.c (fit_command):  Log file contained the wrong variable name
	for axis restrictions.  Reported by Victor Slabinski on gnuplot-bugs.

	* src/fit.c:  Make Ctrl-C interrupt fits in Windows console mode gnuplot
	again.

2013-06-05  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in:  Allow building against either Qt4 or Qt5.
	./configure --with-qt		# Try Qt5 first, fall back to Qt4
	./configure --with-qt=qt4	# Prefer Qt4 to Qt5 even if present
	Note: On my machine use of Qt5 also requires compiler option -fPIC, but
	I have not added this to configure.in.

	* src/qtterminal/{qt_term.cpp QtGnuplotWindow.h QtGnuplotWidget.cpp
	QtGnuplotWidget.h}:  Trivial changes to #include statements required by 
	Qt4->Qt5 module organization. 
	QString::toAscii is deprecated.  Use toUtf8 or toLatin1 as appropriate.

	* src/qtterminal/QtGnuplotScene.cpp (processEvent positionText):
	Older APIs for transformations (rotate/translate/scale) have been removed
	in Qt5.  The new ones seem to work OK in 4.6 also, so I have replaced the
	old ones unconditionally.  If this causes problems we could choose old or
	new based on QT_VERSION.

	* src/scanner.c src/util.c src/util.h:  Allow UTF8 identifiers.

	* src/internal.c (f_range): Allow "string"[x:x] where x is real rather
	than int.   This makes it more convenient to use column data as an index.

2013-06-02  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wprinter.c (PrintDlgProc):  Safeguard against unavailable
	printer info.
	Bug 1152.

	* src/win/wprinter.c (DumpPrinter):  Make this similar to the code in 
	CopyPrint (wgraph.c) which is supposed to work more reliably.

	* src/win/wgraph.c (SaveAsEMF, CopyClip):  Turn off antialiasing during
	export to EMF or clipboard in order not to mix GDI and GDI+ calls.  See
	also change on 2012-07-24.

	* src/misc.c (loadpath_fopen):  Always open files in binary mode on
	Windows.  If this should happen to cause side effects for text inline
	data, there should still be enough time to correct those before the next
	release.
	Bug #880.

	* src/win/wredirect.cpp src/win/winmain.c src/win/wtext.h
	config/mingw/Makefile config/msvc/Makefile:  Redirect C++ cout and cerr
	to Windows text window.

	* src/fit.c (analyze) src/matrix.c|h (sumsq_vec):  Use the Neumaier
	variant of the Kahan and Babuska algorithm to sum up the chisq in order
	to reduce rounding errors.

2013-05-31  Ethan A Merritt  <merritt@u.washington.edu>

	* src/wxterminal/wxt_gui.cpp (wxt_sigint_handler):  The wxt terminal
	deadlocks if connection to the X-server is lost (Bug #991).  Ctrl-C
	doesn't break the deadlock because this interrupt handler simply flags
	the signal and waits for the parent process to handle it.  Parent and
	child are thus waiting on each other -> deadlock.  Now we add a test
	for Ctrl-C arriving when the Ctrl-C flag is already set, and exit if
	it happens. Thus hitting Ctrl-C twice breaks the deadlock.
	Not great but better than hanging.
	Bug #991.

	* src/plot3d.c:  If a surface plot or contour is requested using a funky
	style (histogram? errorbars?) print a warning and then ignore it rather
	than plotting with style "points".

	* docs/titlepag.tex docs/plotstyles.gnu docs/gnuplot.doc:
	Add a sample figure illustrating use of `with labels` to define a set
	of point types as character glyphs and then select which one is used
	based on column data.

	* docs/doc2tex.c docs/gnuplot.doc:
	Tweak page layout of the document produced by 'make pdffigures'.

2013-05-27  Thomas Mattison  <mattison <at> phas.ubc.ca>

	* src/fit.c (regress):  Update all user variables after the fit converges
	or aborts in order to always return the "best" set. Patchset #230.

2013-05-23  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/fit.c (update):  Replace splitpath() by a call to gp_basename().
	Avoid potentially invalid access dicovered by Ethan with the help of
	valgrind.

	* src/fit.c (show_fit1):  Use fputs instead of fprintf when no formatting
	is done.

2013-05-23  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c (get_data): Treating timedata columns as strings allows
	functions column(N) and column("HEADER") to work on time data.
	Bug #1161

	* src/graphics.c: Fix two errors in the linetypes used by plot style
	columnstacked histograms.  The key sample ignored "newhist lt N" and
	also was off by one in the fillstyle used.  "set style increment user"
	caused an off-by-one error in the choice of initial line style.

2013-05-22  Christoph Bersch <usenet@bersch.net>

	* src/gadgets.c(draw_clip_polygon) src/term.c(do_arc):
	Fix polygon clipping code when intersections are degenerate.
	Bugs #1237 #1242

2013-05-22  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c src/stdfn.c (gp_strtod):
	The code that skips leading whitespace in a data file must match the
	behaviour of strtod(), implicitly the same as isspace().
	It is not sufficient to skip space and tab, we must also skip embedded
	\r \v and so on.  This same problem would hit the private implementation 
	gp_strtod(), which fortunately is never used.  So just get rid of it.
	Bug #1243 

2013-05-21  Ethan A Merritt  <merritt@u.washington.edu>

	* term/README src/wxterminal/gp_cairo.c src/qtterminal/QtGnuplotScene.cpp
	Clarify comments about use of term->boxed_text().
	Tweak the bounding box used for regular text in Qt to agree better with
	the bounding box used for enhanced text.

	* src/gadgets.c src/qtterminal/QtGnuplotScene.cpp src/term_api.h
	src/wxterminal/gp_cairo.c term/README term/cairo.trm term/gd.trm
	term/post.trm term/svg.trm term/x11.trm:  Define an enum TEXTBOX_* for
	the options parameter to term->boxed_text().

2013-05-20  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* term/emf.trm:  It doesn't work to call EMF_setfont() before we
	enter graphics state.  Bugfix.

2013-05-19  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in src/gadgets.c src/gadgets.h src/save.c src/set.c
	src/show.c src/tables.c src/tables.h src/term_api.h src/unset.c
	docs/gnuplot.doc:

	New text label attribute `boxed`. The appearance of boxed labels is
	controlled by a new command	
	   set style textbox {opaque|transparent} {{no}border}
	The style options are applied both to individual labels (`set label`)
	and labels generated by a plot command (`with labels`).
	This patchset dates back to 2005, but at that time so few terminals
	could support it (gd, post, x11) that it did not seem worth applying.
	Now we can support Qt and the full range of cairo-based terminals.
	It should be possible to add support for the win and canvas terminals
	as well.  I am not certain about svg or the various latex terminals.

	* term/README term/gd.trm term/post.trm term/PostScript/prologue.ps:
	PostScript and libgd terminal support for boxed text.

	* src/gplt_x11.c term/x11.trm term/xlib.trm: X11 support for boxed text.

	* src/qtterminal/{QtGnuplotEvent.h QtGnuplotScene.cpp QtGnuplotScene.h
	qt_term.cpp qt_term.h} term/qt.trm:  qt terminal support for boxed text.

	* src/wxterminal{gp_cairo.c gp_cairo.h wxt_gui.cpp wxt_gui.h wxt_term.h}
	term/wxt.trm term/cairo.trm: wxt/cairo terminal support for boxed text.

	* term/svg.trm: SVG support for opaque fill behind text. I don't know
	how to stroke the bounding box outline, so no support yet for "border".

	* demo/contours.dem demo/datastrings.dem: Illustrate boxed text labels.

2013-05-18  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c (do_3dplot): For 'set contour; splot ... with labels'
	do not generate extra blank lines in the key box.

	* src/show.c:  Treat "show cntrlabel" as "show contour".

	* src/plot3d.c (eval_3dplots): Give a more informative error message
	on "splot with labels" without a prior "set contour".

	* src/qtterminal/QtGnuplotScene.cpp: Enhanced text elements were not
	being added to the current plot group so that they could be toggled.
	"center" justification was not being tracked.

	* src/graphics.c (finish_filled_curve): Don't try to process an
	empty filled polygon.

2013-05-18  Peter Juhasz  <juhaszp@users.sourceforge.net>

	* src/datafile.c (f_column f_stringcolumn):
	f_stringcolumn now issues a warning if a named column was not found 
	in the header, just as f_column does. Additionally, if there is a
	partial match, print the name in the warning between double quotes.

2013-05-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/wxterminal/gp_cairo.c (gp_cairo_enhanced_flush):  Empirical fix
	for y coordinate after save/restore sequence (enhanced text mode '@').
	I'm not convinced this is correct, but it does seem to work in practice.

2013-05-15  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c src/graph3d.h src/plot3d.c src/save.c src/set.c
	src/show.c src/unset.c:

	Contour styles other than `with lines` are already supported, although
	most styles are treated as either lines or impulses.  We now add support
	for `set contour; splot ... with labels`, which places contour labels on
	the plot itself.  Up till now this has been possible only by using an
	external script to generate and place labels (label_contours.awk).
 
	Format and placement options are controlled by a new command
	    set cntrlabel {start <int>} {interval <int>} {onecolor}
	    set cntrlabel {format "format-spec"} {font "font-spec"}
	`set cntrlabel onecolor` produces the same result as `unset clabel`.
	`set cntrlabel format "foo"` similarly replaces `set clabel "foo"`.
	The old command `set/unset clabel` is retained but is now deprecated.
	Precise layout of the contour labels can be further tweaked by using the
	usual label options in the splot command itself.  E.g.
	    splot $FOO with labels textcolor rgb "blue" point offset -1,1

	Known limitations:  The labels are not handled by hidden3d.  Setting
	large values of samples and/or isosamples can lead to unreasonably
	dense labels even if the repeat interval is disabled by setting to 0.
	Hypertext contour labels are possible, but are uglified by an 
	unnecessary point symbol at each anchor position.

	* docs/gnuplot.doc demo/contours.dem:  Update to illustrate new command.

2013-05-14  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/set.c src/unset.c src/show.c src/save.c src/fit.c|h:  Long brief
	reports can be wrapped using 'set fit wrap <column>'.

	* src/set.c (set_fit):  Need to advance to next token after
	'set fit ... default'.

2013-05-12  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/fit.c:  Setting of user error variables needs to be done in
	regress() since show_results() is not called if 'set fit quiet'.
	Bugfix.

2013-05-11  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c src/graph3d.h src/save.c src/set.c src/show.c 
 	src/tables.c src/tables.h src/unset.c:  Preparation for new command
	set cntrlabels

2013-05-08  Ethan A Merritt  <merritt@u.washington.edu>

	* src/set.c: Remove order dependence of hypertext/point type options.
	Initialize entire text_label structure when allocated.

2013-05-09  Thomas Mattison  <mattison <at> phas.ubc.ca>

	* src/fit.c|h src/save.c src/show.c src/set.c src/unset.c
	docs/gnuplot.doc:  New convergence criterion. The new simpler criterion
	in regress() is absolute reduction in chisquare for an iteration of less
	than epsilon*chisquare plus epsilon_abs (new setting).  The default
	convergence criterion is thus always relative no matter what the
	chisquare is, but users now have the flexibility of adding an absolute
	convergence criterion through `set fit limit_abs`.
	Patch #230.

2013-05-08  Ethan A Merritt  <merritt@u.washington.edu>

	* term/canvas.trm:  Pattern-fill support for the canvas terminal.

	* demo/html/webify_canvas.pl:  Re-order main loop to avoid trailing
	cruft in the output HTML page.  Include support for pattern fill.

	* src/datafile.c:  Remove use of isblank(), since too many of our
	supported platforms are mired back in the pre-C99 era.

	* src/graph3d.c: this_plot->hidden3d_top_linetype is a better start
	point for calculating contour linetypes than the apparent plot l_type,
	because that may have been overwritten by previous definitions.
	This way, splot ... lt N  will always get contour linetypes starting
	with N+1.

	* src/datafile.c:  Valgrind found a case where df_column[foo].position
	had never been initialized.  Boom.

2013-05-08  Thomas Mattison  <mattison <at> phas.ubc.ca>

	* src/fit.c (marquardt):  Zero-change in chisquare is now "BETTER"
	rather than "WORSE" to avoid extra iterations which would only
	increase lambda. 
	Patch #230.

	* src/fit.c (call_gnuplot):  Print useful info on undefined-function
	error. Derived from patchset #230.

	* src/fit.c (fit_command):  If the user supplies errors but any of them 
	are zero, there will be a divide by zero, trashing the fit.  Add a check 
	which prints info about the offending data point before aborting.
	Derived from patchset #230.

2013-05-08  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/fit.c (show_fit1):  Print asterisk instead of magic number -1 for
	iterations which increase the chisquare.

	* src/set.c (set_fit) docs/gnuplot.doc:  Options logfile, limit
	maxiter, start_lambda, lambda_factor, and script accept setting 'default'
	to restore default values or behaviour.  Avoid usage of magic constants.

	* src/fit.c|h:  Cleanup declarations.

	* src/fit.c|h src/save.c src/set.c src/show.c:  The command which can be
	executed by fit when it is interrupted can be changed with
	`set fit script`.

	* src/fit.c src/stdfun.c|h docs/gnuplot.doc:  Print p-value of the fit
	according to the chisquare-distribution.  Saved to user variable FIT_P.

	* src/fit.c (fit_command):  Discard data which contains NaN.  Necessary
	since df_readline() does not return DF_UNDEFINED in that case.  Now
	excluding data from the fit works the same for expressions with e.g. 1/0
	and NaN.

	* src/fit.c (pack_float):  Do not try to dereference NULL result from
	strchr().

	* src/fit.c (fit_command):  New user variable GPVAL_LAST_FIT.

	* src/config/msvc/Makefile:  MSVC does not have isblank() so use
	isspace() instead.

2013-05-06  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c (replotrequest):  Do not trust is_3d_plot as an 
	indicator of whether a replot request should be 2d or 3d; instead 
	check the command itself to see if it is "splot ..." or "plot ...".
	Bug #1235

	* src/qtterminal/QtGnuplotScene.cpp:  fillbox(FS_EMPTY, ...) should
	draw in background color, not necessarily white.

	* demo/html/webify_canvas.pl term/canvas.trm term/js/gnuplot_mouse.js:
	Do not redraw a plot canvas on mouseover if no intervening plot canvas
	has been drawn since the mouse left.  This prevents unnecessary redraws
	if the mouse leaves and then immediately reenters.
	Bug #1220

2013-05-05  Dima Kogan  <dima@secretsauce.net>

	* src/gplt_x11.c src/gplt_x11.h term/x11.trm:
	Previously it was possible for gnuplot to call display() before all
	chunks in an image had been received. This resulted in corrupted plots.
	Now we block display() calls while in the middle of an image transfer.
	Bugfix.

2013-05-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/eval.c (evaluate_at) demo/imageNaN.dem:  Remove old hackish code
	causing inconsistent treatment of Inf and NaN input values depending on 
	platform and undefined behaviour of the C compiler.  Now both
	`using 1:2` and `using 1:($2)` should have the same result, as shown by
	revised imageNaN demo.

2013-05-03  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c (do_arc):  The new routine draw_clip_polygon() is not
	working correctly here.  Revert to the previous explicit loop over
	arc segments using draw_clip_line();

	* src/term.c (term_start_multiplot) docs/gnuplot.doc:
	New command "set multiplot next|previous" skips forward or back one
	position in a multiplot autolayout grid.  I.e. "next" leaves a blank
	area instead of a plot, while "prev" would overwrite the plot that
	was just drawn.

2013-04-27  Ethan A Merritt  <merritt@u.washington.edu>

	* src/save.c (save_variables__sub):  Ignore datablocks when saving
	variables to file.

2013-04-27  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/fit.c src/setshow.h src/show.c:  Extend 'update' so that it
	does no longer require the parameter file to already exist.  Docs
	implied this feature since before the start of the CVS.  'fit' now
	saves the names of parameters and independent variables and this
	info is used by 'update' to create a new parameter file if it does
	not exist yet.  Bug #1156.

	* src/fit.c (backup_file):  Backup files will not get overwritten.
	Add error message for that case.

	* src/util.c|h (existfile) src/win/winmain.c:  New routine.

2013-04-26  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c (df_tokenise): Because the individual lines of an
	internal data block ("here data") end in \n rather than \0, the test
	for termination of the final field on the line could fail.  This led
	to attempted memory access beyond the end of the block.

	* src/datafile.c (df_tokenise check_missing):  Treat empty fields in
	a csv file as "missing" rather than "bad".  This allows generating
	stacked histogram plots from a csv spreadsheet of sparse data.

	* src/datafile.c (df_tokenise):  Since we now test for an unwanted \n
	at the end of a line of data, we might as well test for \r also.
	That means DOS format *.csv files can be read without conversion.

2013-04-25  Lars Hecking  <lhecking@users.sourceforge.net>

	* Makefile.am docs/Makefile.am man/Makefile.am: Clean up processing
	of lisp files gnuplot-gui.elc and gnuplot.elc, packaging of file
	figure_missing.pdf.

2013-04-25  Christoph Bersch <usenet@bersch.net>

	* src/gadgets.c src/gadgets.h src/graphics.c src/term.c:
	Implement the Sutherland-Hodgman algorithm for clipping a general
	polygon against a rectangular bounding box.  Apply this to clip
	polygon objects (including circles and ellipses) and arrowheads.

	* src/graphics.c (plot_filledcurves finish_filled_curve):
	Use new polygon clipping code for filledcurves.

2013-04-24  Thomas Mattison  <mattison <at> phas.ubc.ca>

	* src/fit.c:  Optional one-line progress reports. Move code to output
	status reports and final results to new routines.
	Patchset #230.

	* src/fit.c (regress):  Fit did not converge if maximum lambda was
	exceeded.  Add new message for this case.

2013-04-24  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/fit.c|h src/save.c src/set.c src/show.c src/unset.c docs/gnuplot.doc:
	New options quiet|results|brief|verbose for `set fit` to select verbosity
	of fit's output.  Default to brief one-line reports.  'verbose' selects the
	traditional full report.

	* src/fit.c (backup_file):  Remove code path for Win32s.

	* src/fit.c (show_results):  Print correlation matrix only if there is
	more than one parameter.

	* demo/fit.dem:  Update to new syntax. Reduce number of pause statements,
	remove plots which show only the data or duplicate techniques already
	demonstrated.  Add some more comments and plot titles.

	* src/show.c (show_variables):  Avoid extra newline in output.

	* src/win/wgnuplib.h src/win/wgraph.c src/win/wresourc.h term/win.trm:
	Speed up rotating graphs with the mouse by temporarily disabling
	antialiasing.  Add user interface and ini file setting.

2013-04-22  Bastian Maerkisch  <bmaerkisch@web.de>

	* term/win.trm (WIN_options):  Validate argument to title option.

	* term/dumb.trm (DUMB_options):  New option to change aspect ratio of 
	the plot by setting tic lengths. Change default to 2:1, which corresponds
	more to the default fonts found on the systems I tested.

	* src/fit.c|h src/win/wgraph.c src/win/wtext.c:  Unlike on any other
	platform, long fit runs cannot be interrupted on Windows. Fix this
	long standing issue at least for wgnuplot by handling Ctrl-Break.

	* docs/gnuplot.doc:  Update help texts for `fit`.

	* src/win/winmain.c|h (WinRaiseConsole) src/fit.c src/win/wgraph.c
	src/wxterminal/wxt_gui.cpp: Consolidate code to raise console in new
	routine.

2013-04-22  Ethan A Merritt  <merritt@u.washington.edu>

	* src/wxterminal/wxt_gui.cpp (wxt_init):  Exit cleanly if initialization
	fails.

	* src/wxterminal/gp_cairo.c (gp_cairo_set_font):  Allow backslash ('\\')
	to be treated as an escape character in font names.  This can be 
	necessary if the font name contains a hyphen, which would otherwise be
	converted to a space.

	* src/qtterminal/QtGnuplotScene.cpp (processEvent):  Add pixmaps to 
	current plot group so that image plots can be toggled.

	* src/set.c src/unset.c:  Repair a small memory leak from the sequence
	set key font 'something'; reset

2013-04-21  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gplt_x11.c term/x11.trm:  X11 terminal support for toggling plots
	on/off by left clicking on the corresponding key entry.  The toggle
	works for all x11 plot windows, not just the currently active one.

	* docs/gnuplot.doc src/datafile.c src/datafile.h src/plot2d.c src/save.c
	src/set.c src/show.c src/unset.c src/util.c:  Allow more than one 
	character to be specified as a data field separator.  For example:
	    set datafile separator "|:\t"
	means that a field may be terminated by either | or : or tab.

2013-04-20  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/fit.c|h src/save.c src/set.c src/show.c src/unset.c demo/fit.dem
	docs/gnuplot.doc:  New options for `set fit`. These options will replace
	the FIT_* user variables to be consistent with how the rest of gnuplot's
	options are controlled. For now the `set fit` commands simply set (or
	undefine) the corresponding FIT_ variable to keep backwards compatibility.

2013-04-12  Ethan A Merritt  <merritt@u.washington.edu>

	* src/stats.c:  Fix incorrect memory allocation for large matrices.

2013-04-10  Ethan A Merritt  <merritt@u.washington.edu>

	* term/pslatex.trm (EPSLATEX_set_color):  Revert a portion of the patch
	from 2013-01-08 (Tracker #1199).  Repairs overzealous removal of
	redundant color commands.  Bug #1185.

	* Makefile.am:  Add lisp subdirectory to the list of files in EXTRA_DIST.
	This forces the subdirectory to be recreated even if it is currently
	disabled, and thus allows "make dist" from inside a tree that has been
	configured --without-lisp-files.

2013-04-09  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c src/plot3d.c src/set.c(parse_label_options) src/setshow.h
	parse_label_options() is called both from "set label ..." and from
	"plot ... with labels". The latter case should not accept keywords "at",
	"front", "back".

2013-04-08  Dima Kogan  <dima@secretsauce.net>

	* src/gplt_x11.c: Calculate window resizing based on gheight (plot only)
	rather than height (full window).

2013-04-08  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in src/term.h:  Remove gpic (minimal line art sent to groff)
	hp2623a (mid 1980s graphics terminal a.k.a. "the ET-head") and
	hp2648 (1979 720x360 dot graphics terminal) from the set of terminals
	configured in by default.

2013-04-07  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c (make_tics):  Test for an autoscaled axis that is enabled
	but has no corresponding data (e.g. "set x2tics; plot ... axes x1y1").
	In this case warn and skip tick generation rather than stopping with an
	error.

	* src/graphics.c (plot_image_or_update_axes)
	src/plot2d.c (refresh_bounds):
	Refresh of image plots tested only for autoscaling on x; now we also
	test for autoscaling on y.

	* src/axis.h: Do not add an extraneous factor of 1e-3 to the axis
	limits of a refreshed plot.  Yes it prevents log-scale axes from
	overflowing when zoomed out, but also it prevents the endpoint
	values from being recognized as autoscaled.  A different fix is
	needed for the overflowing log-scale axes.

	* src/mouse.c (apply_zoom): Partial fix for the above problem.
	If the x2 or y2 axis limits contain the magic value VERYLARGE,
	the initial state of autoscaling, then don't try to interpret it
	as an actual numerical value passed to "set x2range".
	Bug #636.

2013-04-06  Ethan A Merritt  <merritt@u.washington.edu>

	* src/set.c (set_range): Add a loop to parse axis range options
	so that there is no order dependence.  Add "noextend" option.

2013-04-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gp_time.h term/js/gnuplot_mouse.js term/js/gnuplot_svg.js:
	Change zero point of time coordinates to the unix epoch boundary
	1-Jan-1970.  Previous to this change gnuplot used a zero point of
	1-Jan-2000, which caused various user-visible problems when times
	were input or manipulated as raw seconds.
	Reversion to the previous choice of epoch boundary can be done by
	replacing a single #if (0) in gp_time.h and reverting the
	corresponding time calculation in the javascript files.

	* src/mouse.c src/time.c docs/gnuplot.doc:  Remove unused code
	and comments specific to the older use of a private epoch.

2013-04-04  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/wxterminal/wxt_gui.cpp (wxtPanel::RaiseConsoleWindow),
	src/wxterminal/wxt_gui.h: Implement space-raises-console for
	Windows console mode gnuplot.

2013-04-04  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/gnuplot-ja.doc, docs/term-ja.diff:
	Sync with English documentation (rev.1.774)

2013-04-04  Dima Kogan  <dima@secretsauce.net>

	* src/axis.h src/axis.c src/plot2d.c src/plot3d.c:
	Restore the original state of the "reverse" autoscaling flag when
	refreshing (as opposed to replotting).

2013-04-04  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/plot.c (main): Restore a code snippet for the Windows platform
	which got removed by accident on Feb 3rd. Fixes -persist mode on
	Windows.

2013-04-02  Christoph Bersch  <cbersch@users.sf.net>

	* term/post.trm term/PostScript/prologue.ps: Revise the code embedded
	to skip Level2 PostScript features if /Level1 is set to true in the
	header records at the top of an output *.ps or *.eps file.  The old
	version failed if a level 2 image > 64kBytes was encountered.

2013-04-01  Christoph Bersch  <cbersch@users.sf.net>

	* term/post.trm: Add support for /FlateDecode compression of images.
	The image is created as a PNG image using either the libgd or libcairo
	library depending on which (if either) is present in the current build
	of gnuplot.  The /FlateDecode method is only used if the terminal option
	"level3" is given to "set term post".

2013-04-01  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot3d.c:  Incomplete initialization of sample range variable.

	* src/plot2d.c docs/gnuplot.doc:  Provide an indexed example of using
	"smooth frequency" to generate a histogram.  Do not let this plot mode
	override the user's data style.

2013-03-29  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c src/term_api.h term/svg.trm:
	Use actual plot title as the <title> attribute of svg plot elements.
	If there is no plot title, use name_plotno_panelno as before.

	* src/qtterminal/QtGnuplotScene.cpp (processEvent):  Fix off-by-one
	iteration over visibility of plots after a zoom or other replot.

2013-03-21  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c src/misc.c (lp_parse):  The "fillcolor|fc" keyword
	in a plot command was not correctly parsed.

	* src/term.c (term_apply_lp_properties): A patch of 2013-01-08
	switched to always applying linetype color even if the use_palette
	flag was not set.  This broke the TERM_MONOCHROME setting on terminals
	that have it, as seen in the "test" command.
	Handle monochrome terminals as a special case.
	Bug #1225

2013-03-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/mouse.c:
	Combined mousing revisions from Michael Madsen, Petr Mikulik, and
	Mojca Miklavec.
	Zoom in/out around current mouse position rather than center of plot.

	+/- keys             zoom in/out on mouse position
	<wheel-up>           scroll up (in +Y direction)
	<wheel-down>         scroll down.
	<shift-wheel-up>     scroll left (in -X direction)
	<shift-wheel-down>   scroll right.
	<Control-WheelUp>    zoom in on mouse position
	<Control-WheelDown>  zoom out on mouse position
	<Shift-Control-WheelUp>    pinch on x
	<Shift-Control-WheelDown>  expand on x

2013-03-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c src/datafile.h src/plot2d.c src/plot3d.c:
	Issue a warning if a requested column header is not found in the
	data file being plotted.  Document that an exact match is required.

2013-03-12  Carl Michal <michal@phas.ubc.ca>

	* src/fit.c src/fit.h src/save.c src/set.c src/show.c src/unset.c:
	"set fit [no]prescale" optionally normalizes fit parameters before
	starting M-L refinement.

2013-03-09  Dima Kogan  <dima@secretsauce.net>

	* src/gplt_x11.c:  Some window managers produce multiple ConfigureNotify
	events when a window is created. Some of these were mis-interpreted by
	gnuplot_x11 as a refusal to resize, which then issued additional
	unneeded replot actions. Now we wait for 0.1 second for extra
	ConfigureNotify events before deciding that a resize was rejected.

	* src/plot3d.c (refresh_3dbounds):  Partial axis ranges, e.g. [*:MAX] or
	[MIN:*] were not being handled correctly when refreshing volatile data.

	* src/plot2d.c (refresh_bounds) src/plot3d.c (refresh_3dbounds):
	Extend degenerate range when refreshing.

2013-03-03  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c:  Allow a 2 columns only variant of "with yerrorbars".
	x is taken from column 0, y from column 1, yerror from column 2.

2013-03-02  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/win/wtext.h: Avoid redefinition error for ungetch.

	* src/makefile.awc (COREOBJS): Add new module to Watcom make file
	list, too.

2013-03-01  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c (refresh_bounds):  Partial axis ranges, e.g. [*:MAX] or
	[MIN:*] were not being handled correctly when refreshing volatile data.

2013-02-28  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c (replot_command):  If the input data comes from stdin
	and is marked volatile, i.e.  plot '-' volatile,  then treat a replot
	command as if it were a refresh command.  This is a change, but is
	consistent with the documentation for the "volatile" keyword.

	* src/plot2d.c (eval_plots):  The range check on functions with a
	private sampling range did not allow for log scaling.
	Bug #1215

2013-02-27  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c src/boundary.c src/boundary.h src/Makefile.am:
	graphics.c has grown into the largest single gnuplot source file
	(7000+ lines).  Split out the routines dealing with key and border
	layout into a new separate file boundary.c.

	* src/color.c src/pm3d.c src/interpol.c:
	Remove unneeded #include headers.

	* src/axis.c src/gadgets.c src/gadgets.h src/graphics.c src/graphics.h
	(label_width):  Move routine label_width() from graphics.c to gadgets.c.

	* src/graphics.c src/graphics.h src/gadgets.h src/gadgets.c
	src/util3d.h src/pm3d.c:  Move routine apply_head_properties() from
	graphics.c to gadgets.c.

2013-02-26  Ethan A Merritt  <merritt@u.washington.edu>

	* docs/gnuplot.doc: Simplify description of binary file handling.
	Do not imply that text files are limited to ascii encoding.

	* docs/old/makefile.r: Remove ancient version of makefile.

	* configure.in src/Makefile.am man/lasergnu.1 man/Makefile.am
	src/lasergnu: Remove ancient script that piped a file through gnuplot
	and then via lpr to a (by default Imagen) printer. This script has
	been deprecated since version 4.0.

	* configure.in src/term.h:  Remove imagen (1980s/1990s laser printer)
	from default set of included terminals.

	* src/show.c src/version.c src/version.h src/plot.c:
	Remove the "Build system" line from the version information shown on
	entry.  It never did report the build system, only the system reported
	by the machine it was currently running on.   Could be replaced if
	someone wants to figure out a generic way to have autoconf fill in the
	OS definition in syscfg.h

2013-02-24  Ethan A Merritt  <merritt@u.washington.edu>

	* term/aquaterm.trm:  Revert patch of 24-Apr-2012 because it breaks
	rgbimage with aquaterm 1.1.  Reversion confirmed to fix the problem
	by Alexander Hansen of Fink.
	Bug #1188

2013-02-22  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in config/makefile.unx configure.vms config/makefile.dj2
	config/makefile.emx config/makefile.vms
	src/makefile.awc src/makefile.all src/Makefile.in src/term.c src/term.h
	term/cgi.trm term/Makefile.am term/Makefile.in docs/Makefile.am:
	Remove vestigial support for the SCO "cgi" graphics layer that sat on
	top of AES and VDI. This was a graphical environment for the IBM PC
	and the Atari ST. PC GEM was a fairly widely used GUI until the
	release of Windows 3.0. The SCO cgi variant existed also on SCO unix.

2013-02-21  Ethan A Merritt  <merritt@u.washington.edu>

	*  src/plot.c:  The old test for whether a session was interactive
	assumed that everything on the command line was either an input file
	name or an x11 option parsed by X11_args. This broke because
	(1) x11 is no longer the only interactive terminal.
	(2) there are options that occupy space on the command line but are
	not file names.  Some indicate non-interactive; some don't.
	Replace this test with one that only enters a non-interactive session
	if there are command line arguments that do not begin with '-'
	(filename) or _do_ begin with '-e' (inline command).
	Bug #1212

2013-02-19  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* src/axis.c (gen_tics) src/unset.c (unset_log):  Do not zero out the
	log base when log scaling is disabled.  This allows gprintf formats
	%L and %l to work even when the axes are linear.

2013-02-19  Ethan A Merritt  <merritt@u.washington.edu>

	*  src/graphics.c (boundary):  Rotated x-axis tic labels are set
	automatically to right justify, but this happens too late for the code
	that reserves space for them.  Test for this as a special case.
	Bugs 1204, 1209

	* src/wxterminal/wxt_gui.cpp (wxt_update_key_box):  Fix array overrun
	caused by many 'notitle' plots appearing before any titled plots.
	Bug 1211

2013-02-18  Christoph Bersch  <cbersch@users.sf.net>

	* src/graphics.c:  Draw the zero axis lines in the same front/back
	layer as the axis and grid lines.

2013-02-18  Ethan A Merritt  <merritt@u.washington.edu>

	*  src/term_api.h term/cairo.trm term/canvas.trm term/svg.trm
	term/wxt.trm src/wxterminal/gp_cairo.c src/wxterminal/gp_cairo.h
	src/wxterminal/wxt_gui.cpp src/wxterminal/wxt_term.h:
	Add "square" to linecap options "round" and "butt".

2013-02-17  W. Trevor King  <wking@tremily.us>

	* configure.in src/datafile.c (df_open) docs/gnuplot.doc:
	New special file syntax  "<&N"  plots data read from an arbitrary file
	descriptor.  This allows setting up multiple input pipes to gnuplot
	when it is invoked from a shell.

2013-02-17  Craig DeForest  <deforest@boulder.swri.edu>

	* src/datafile.c (df_readbinary):  Add special case code to read in a
	uniform binary matrix in one large chunk rather than reading one matrix
	element at a time.  When piping a 2000x2000 RGB matrix under linux this
	speeds the input stage from about 9 seconds to about 2 seconds.

2013-02-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c src/datafile.c src/plot2d.c src/plot3d.c src/binary.c
	src/Makefile.am:  Files binary.c and binary.h are not used by gnuplot
	proper, only by bf_test.  Remove them from the build dependencies.

	* src/plot.c: Treat command line option -e similarly to a load file
	(i.e. do not wait for further input from stdin).

2013-02-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot.c:  Merging the option parsing code from the old Windows
	version and the old X11 version left a conflict as to whether the
	`interactive` flag was always set if there were no filenames on the
	command line.  The 03-Feb-2013 version always set it (as per Windows)
	but this broke use of the Gnuplot.pm perl module under linux.
	Therefore I have removed the unconditional statement interactive = TRUE.

2013-02-08  Ethan A Merritt  <merritt@u.washington.edu>

	* util.c (gprintf):  Initialize output buffer so that an empty format
	does not leave an unitialized string.  Test case:
	set format "%B %b"; plot x

2013-02-03  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot.c:
	-d or --default-settings Skip reading gnuplotrc and ~/.gnuplot on entry.

	* src/plot.c:
	Don't assume that X11_args() is there to help parse command line options.
	Bug #3601907

2013-02-02  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c (read_line):  Reset the token count to zero when
	starting to read a new line of input.  Otherwise if the read is
	interrupted by a mouse event requesting a replot then the internal
	state is not valid.  Test case:   cat | ./gnuplot      plot and zoom
	Bug #3602388 (new #1203)

2013-01-25  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c (bind_command):  Convert the last caller of quote_str()
	in the core code to use instead try_to_get_string().  I.e. allow
	STRING = "some command"
	bind KEY STRING

	* term/ai.trm:  Replace quote_str() with try_to_get_string()
	  Allows font to be provided as a string variable.

	* term/vgagl.trm:  Same
	* term/corel.trm:  Same
	* term/djsvga.trm: Same

	* src/util.h src/util.c:  The routine quote_str() no longer has any
	callers except the next/openstep terminals.  Mark it #ifdef NEXT.

2013-01-24  Ethan A Merritt  <merritt@u.washington.edu>

	* src/set.c (set_timefmt):  Accept the new format as a string variable.
	Bug #3602057

2013-01-21  Ethan A Merritt  <merritt@u.washington.edu>

	* src/hidden3d.c:  Up until now hidden3d handled any pm3d surfaces as
	a collection of points, which did essentially nothing at all.  Now we
	treat them as invisible lines (LT_NODRAW) so that they can occluded
	other objects.
	This trick was already used in hidden2.dem but now it's built in.

2013-01-18  Ethan A Merritt  <merritt@u.washington.edu>

	* term/x11.trm:  Right- or Center- justified enhanced text was losing
	track of the font size.  This bug was evident in "key.dem".

2013-01-08  Ethan A Merritt  <merritt@u.washington.edu>

	* term/pslatex.trm (EPSLATEX_layer):  Reset current text color at the
	start of each layer's block of TeX output.  Bug #3599916

	* src/term.c (term_apply_lp_properties):  Always apply linetype color,
	even if the flag use_palette is not set.  Many terminals cope with this
	on their own, but not all of them (e.g. cairolatex).
	Bug #3599916

	* src/hidden3d.c (in_front):  Inline the single line subroutine
	handle_edge_fragment() at its sole call site.

2013-01-07  Ethan A Merritt  <merritt@u.washington.edu>

	* src/mouse.c term/x11.trm: Fix aspect ratio error introduced 2013-01-05

2013-01-06  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot.c (main): Unbuffered stdin is needed for readline even if
	X11 is not configured, as suggested in the comment from 2004.

	* src/command.c (invalid_command): When an invalid command is detected,
	advance the input parsing pointer (c_token) to the end of the command.
	Otherwise we're left in the middle of an invalid command after the
	error message is printed.

2013-01-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/mouse.c (do_event):  Testing for multiplot when a signal is
	received from gnuplot_x11 is pointless because gnuplot no longer has any
	idea whether the plot window sending the event contains a multiplot.
	Clean up the X11-dependent code that responds to GE_fontprops events.

	* src/term.c: Move term_start_plot() to after the multiplot flag is set.
	This lets the terminal take a different action if necessary.

	* term/x11.trm (X11_graphics):  Disable replot_on_resize if this is a
	multiplot.  FIXME:  Better would be to save and restore.  But how?
	Better yet, gnuplot_x11 could keep track of whether it is currently
	displaying a multiplot, and if so suppress the replot requests.
	Variables visible externally should be named X11_<foo>.

	* term/x11.trm (X11_waitforinput): waitforinput() handling of
	GE_fontprops must be protected by IPC_LOCK.

	* src/gplt_x11.c: dashedlines and replot_on_resize are tristate enums,
	not TBOOLEANS.

	* src/qtterminal/QtGnuplotWidget.cpp:  Don't even pretend to pass font
	metrics via GE_fontprops;  only the window height + width are valid.

	* src/graphics.c (do_polygon): Skip degenerate polygons (fewer than 2
	vertices).

2013-01-04  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/gadgets.h (E_Refresh_Allowed, TRefresh_Allowed): New
	enum/typedef to avoid magic constants in code using refresh_ok;
	(refresh_ok): Change to new type.
	(SET_REFRESH_OK): New macro to mask write accesses to refresh_ok
	and refresh_nplots if VOLATILE_REFRESH is not defined.

	* src/gadgets.c: Change definition of refresh_ok to new type.

	* src/set.c (set_logscale): Use new macro.

	* src/unset.c (unset_logscale, reset_command): Use new macro.

	* src/plot3d.c (eval_3dplots): Use new macro.

	* src/plot2d.c (eval_plots): Use new macro.

	* src/command.c (do_string_replot, refresh_request): Replace magic
	numbers by enum values.
	(replotrequest): Use new macro.

	* src/mouse.c (apply_zoom, event_buttonpress, do_save_3dplot):
	Replace magic numbers by enum values.

2013-01-04  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c (replotrequest):  #ifdef VOLATILE_REFRESH is needed with
	./configure --disable-volatile-data

2012-12-31  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c: Add a comment documenting the reason for
	problems with font size changes in terminals such as x11.

2012-12-29  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* docs/Makefile.am (gnuplot.texi): Generated file has to be copied
	back to srcdir in out-of-tree builds.

	* docs/gnuplot.doc, docs/gnuplot.texi: Finally document that "set
	timefmt" accepts an axis argument.

2012-12-27  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* term/emf.trm: Adjust vertical centering of characters to match
	current font size.

2012-12-27  Daniel J Sebald <daniel.sebald@ieee.org>

	* configure.in:  Repair shell syntax used to control the definition
	of CC and CXX for cross-building.

2012-12-27  Ethan A Merritt  <merritt@u.washington.edu>

	* src/wxterminal/gp_cairo.c: Vertical line centering must take into
	account the current oversampling factor.

	* src/graphics.c (draw_titles): Create a separate routine that draws
	the plot title and axis labels.  Make these "front" rather than "back"
	text elements.

2012-12-26  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/gnuplot-ja.doc: Sync with English documentation (rev.1.764)

2012-12-25  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gplt_x11.c:  Keep a list of previously satisfied font requests for
	the x11 terminal driver. This greatly reduces the number of attempts
	needed to find a usable font if the requested default is not available.
	Bug #3152583

	* src/gplt_x11.c term/x11.trm:  Trap a few easy-to-make errors in
	requesting UTF-8 encoding with x11.

2012-12-21  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/qt_term.cpp term/cgm.trm term/x11.trm:
	These terminals support dashed lines but not the "dashlength" keyword.
	They should silently ignore it rather than triggering an error.

	* src/datafile.c src/datafile.h src/stats.c docs/gnuplot.doc:
	Return the number of columns in the first row of a data set as
	STATS_columns.

2012-12-19  Olaf Booij  <obooij@users.sourceforge.net>

	* src/graph3d.c:  In 3D plots with 'set view equal xyz' the point about
	which zoom operates should be in the middle of the screen, not at z=0.

2012-12-18  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c (enhanced_recursion):  Depending on the terminal type and
	the current encoding, improper enhanced text syntax could cause anything
	from garbage text to a segfault:
	  set termopt enhanced; 
	  set label "~"; plot [0:1][0:1] '+' using 1:1:("~^") with labels
	Bugfix

	* src/gplt_x11.c:  Change the fallback font string used when the current
	encoding is UTF-8 (iso10646-1) or when all else fails (iso8859-1).  This
	is admittedly biased towards English as a default, but the previous
	string (*-*) does not work for common recent x11 implementations.

2012-12-16  Ethan A Merritt  <merritt@u.washington.edu>

	* demo/key.dem src/graph3d.c (boundary3d do_3d_key_layout)
	src/graphics.c (boundary do_key_layout do_key_bounds draw_key):
	Refactor the key box layout code to repair several problems.
	- left/right/center was not honored for an explicit key position
	- incorrect key placement due to subscript or superscript in key title
	- text spacing should be based on key font, not on the default font
	- vertical centering of text in key samples was incorrect
	Remaining problems:
	- postscript terminal does incorrect vertical centering (vshift)
	- maxcols is never checked in the splot key layout code
	Bug #3556892  and other issues visible in key.dem

	* term/post.trm (set_font): Quick fix to redefine vshift every time the
	current font size changes. A better fix would query the font internally.

	* term/svg.trm (set_font): Similar fix for svg font metrics.

	* src/wxterminal/gp_cairo.c (gp_cairo_draw_text):  And for wxt.

2012-12-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c:  If a data column requested by name is not found,
	treat it as undefined (DF_UNDEFINED) rather than terminating data input
	with int_error().  This makes the treatment of named columns more like
	that of numbered columns.
	Bug #3595672

	* src/save.c src/set.c src/show.c:  The hypertext flag on labels was
	being ignored by save and show commands.  Setting the flag worked only
	for certain orders of `set` options.
	Bugfix

	* src/datafile.c src/graph3d.h src/graphics.h src/plot2d.c src/plot3d.c
	demo/piecewise.dem docs/gnuplot.doc:
	Extend the support for piecewise sampling ranges, in particular the use
	of named variables in piecewise functions.  Allow 1-dimensional 
	parametric functions in 3D. For example, to plot a helix
	  splot [-2:2][-2:2] sample [h=1:10] '+' using (cos(h)):(sin(h)):(h)

2012-12-02  Ethan A Merritt  <merritt@u.washington.edu>

	* term/svg.trm:  Background color 0x0 was incorrectly interpreted as
	"none" rather than "black". Bugfix.

	* docs/gnuplot.doc:  Update new features section.

2012-11-29  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* config/watcom/.cvsignore: Ignore gnerated file.

	* docs/psdoc/.cvsignore: Ignore generated files.

	* docs/.cvsignore: Ignore Makefile.in, now that it is a generated file.

	* src/qtterminal/.cvsignore: Ignore Makefile.in, since it is a generated file.

	* term/x11.trm (X11_options): Calls to strncat were risking buffer
	overflow by not accounting for the terminating '\0'.  Replace some
	buffer size macros by actual size of buffer.

	* term/wxt.trm (wxt_options): Dito.

	* term/cairo.trm (cairotrm_options): Dito.

	* src/win/pgnuplot.c (main): Dito.

	* src/wxterminal/gp_cairo.c (gp_cairo_add_shape, gp_cairo_enhanced_flush): Dito.

	* term/context.trm (CONTEXT_options): Dito.  And let break
	statements have their own lines instead of hiding them at the end
	of a wrapped function call.

	* src/axis.h (AXIS_INDEX, FIRST_AXES, SECOND_AXES): Replace magic
	numbers by references to existing entries.
	(AXIS_INDEX): Replace macro NO_AXIS by enum entry, to avoid
	warnings about mixing enum with non-enum values.
	(STORE_WITH_LOG_AND_UPDATE_RANGE): No need to invoke strcmp()
	where a simple comparison of enums would suffice.

	* src/help.c (ShowSubtopics): Replace magic numbers by actual
	buffer sizes and string lengths involved.

	* src/command.c (read_line): Replace magic number by expression
	based on actual buffer size.

	* src/gp_types.h (PLOT_STYLE): New enum entry PLOT_STYLE_NONE, to
	be used instead of magic number -1.

	* src/misc.c (get_style): Use new enum entry.

	* src/tables.c (plotstyle_tbl): Use new enum entry.

	* src/save.c (save_data_func_style): Use new enum entry.

	* src/graph3d.c (do_3dplot): Use new enum entry.

2012-11-26  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wgraph.c src/win/winmain.c|h (WinMessageLoop) src/win/wtext.c:
	Move Windows message handling from TextMessage() to new WinMessageLoop()
	and make it accessible in Windows console mode.

	* src/command.c (pause_command): In Windows console mode, handle case
	when current terminal does not have a waitforinput method. Bug fix.

	* src/term.c (write_multiline): Fix alignment of right- or center-
	justified text for terminals which do not have a justify method.

	* src/graphics.c (do_rectangle): Add newpath/closepath calls.

	* src/show.c (show_version): If the environment variable GNUPLOT_PS_DIR
	was set, show its value instead of the compile time setting.

	* src/fit.c: Test for error scaling when printing results.

2012-11-24  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c src/axis.h src/datafile.c src/plot2d.c src/plot3d.c
	src/fit.c demo/piecewise.dem:
	Add support for piecewise functions by adding an optional sampling range
	at the beginning of each element in a plot command. For example, to plot
	a data set and three separate functions covering parts of the range:
	    plot DATA, [10:20] f(x), [25:35] g(x), [40:*] '+' using 1:(h($1))

	* term/svg.trm:  Support for dashlength

	* src/set.c src/tables.c:  Allow "set termoption dashlength <foo>"
	* term/{canvas cgm emf gd metapost pdf post}.trm:
	Recognize 'set termoption' even when not the first command on a line.

2012-11-23  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c src/parse.c:  Internal implementation of a pseudocolumn
	(-3) that means "last column in input file".  I.e. if the input file has
	19 columns then column(-3) is treated as column(19). It might be nice to
	wrap this so that the user interface is something like column(LAST), but
	that remains to be done.

	* src/hidden3d.c:  Handle explicit surface in hidden3d mode.

2012-11-20  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c:  Truncate requested column number to maximum sane
	value. This prevents segfault on "plot $foo using 1 title column(12345)"

	* src/parse.c (parse_unary_expression):
	Collapse two operations PUSHC <pos-const> + UMINUS
	into a single operation PUSHC <neg-const>
	This saves both space and time when evaluating negative numbers, but the
	direct motivation is to make it easier to treat functions of a constant
	value as a special case.

2012-11-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c (plotrequest):  Fix bug introduced by 2012-11-12 patch
	(failure to recognize nonparametric named variables).

	* src/graphics.c (boundary): Since the vertical height of each text
	element depends on the font it uses, temporarily set the font while 
	calculating the height of that element.  This can result in a different
	placement compared to previous versions when a non-default font is used.

	* demo/named_var.dem demo/rugplot.dem demo/all.dem demo/simple.dem:
	Add a unit test for the use of a nonparametric named variable;
	it would have caught the above named variable bug!
	Add a title to simple.dem illustrating the effect of font size on
	placement.  Add a rugplot demo.  Less screen output from fit demo.

2012-11-15  Ethan A Merritt  <merritt@u.washington.edu>

	* src/tabulate.c:  Fix the hexadecimal format used to output RGB color

	* term/js/canvasmath.js:  Additional UTF-8 mathematical operators

	* term/canvas.trm:  Retain the initial font size for later use.
	Reset dashed line status before filled box or polygon (not sure why
	this is necessary, but omitting it causes strange things to happen).

	* src/gplt_x11.c:  Depending on the order of linetype changes, the
	code could fail to reset the current linewidth.
	Bug #3348942

2012-11-12  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c src/axis.h src/fit.c src/plot2d.c src/plot3d.c:
	Merge parse_range() and parse_named_range() into a single routine.
	Clean up the code and the call sites.

	* src/datafile.c (plot_option_using):  Restore a check for a format 
	spec given after the list of columns (e.g. plot XX using 1:2 "%lf; %lf")
	that was lost in a code reorganization and missing in 4.6.0 and 4.6.1.
	Bug #3586441

	* src/command.c (pause_command):  Further cleanup of the code that 
	waits for input after a "pause -1" command.  Eat up characters from
	stdin one by one until a \n is encountered.  No need to store them.

	* src/plot2d.c (check_or_add_boxplot_factor):  Fix memory leak.

	* demos (various): Tweak demos so that they exercise more options,
	giving more coverage of the code when used as a set of unit tests.

2012-11-10  Ethan A Merritt  <merritt@u.washington.edu>

	* src/misc.c (parse_color_name) share/gnuplotrc:  If the expression in
	`linecolor rgb <expression>` is not interpretable as a color name or 
	hexadecimal string "#RRGGBB" then treat it as an integer representing
	AARRGGBB.  Provide examples in gnuplotrc of user-defined functions to
	map RGB or HSV colors using the [0:1] range onto gnuplot's "#AARRGGBB"
	hexadecimal string notation.

2012-11-08  Dima Kogan  <dima@secretsauce.net>

	* src/gplt_x11.c:  Revise placement of the %n format used to read from
	the input stream. This avoids an ambiguity in the standard for treating
	spaces immediately preceding %n.

2012-11-07  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c (gen_tics):  Axis tic labels provided by the user as string
	constants were arbitrarily truncated to MAX_ID_LEN before printing.
	No truncation is necessary.
	Bug #3585182

	* src/axis.c (setup_tics) src/plot2d.c (eval_plots):
	Enable auto-scaling for data sets plotted using the secondary axis
	of a linked axis pair.  E.g.   set link y; plot FOO axes x1y2

	* src/set.c (set_encoding):  Fix memory leak.

2012-11-04  Ethan A Merritt  <merritt@u.washington.edu>

	* src/util.c (gprintf): Ever since the gprintf routine was added
	(sometime before version 3.7) the count parameter that should limit how
	many characters are written on output has been silently ignored.
	Obviously this can lead to buffer overflows, the simplest case being a
	format consisting of a string constant with length > MAX_ID_LEN.
	Revise gprintf() to use snprintf() and safe_strncpy() throughout.
	Bug #3577439

2012-11-03  Clement Law  <themanifold@gmail.com>

	* src/pm3d.c src/pm3d.h src/save.c src/set.c src/show.c:
	Add rms option for 'set pm3d corners2color'.

2012-11-01  Ethan A Merritt  <merritt@u.washington.edu>

	* term/gplt_x11.c: Yet another bug fix for the new text fragment format.

	* src/qtterminal/qt_term.cpp src/qtterminal/QtGnuplotScene.cpp
	src/qtterminal/QtGnuplotWidget.cpp:  Fix mouse tracking and resize
	events for persistent qt windows.

2012-10-31  Ethan A Merritt  <merritt@u.washington.edu>

	* src/parse.c (parse_reset_after_error) src/parse.h src/util.c:
	Error exit from inside try_to_get_string() left the internal flags for
	string parsing in an incorrect state.  Provide a reset routine.

	* src/mouse.c (event_buttonrelease): Save/restore event parameters
	across the check for a user command bound to a mouse button.

2012-10-30  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c: Fix a coding error, (sizeof((char *)buf) rather than
	(strlen((char *)buf)), that can cause a buffer overrun on 64-bit
	machines.  Found by valgrind.

	* src/gplt_x11.c: The new read format for text fragments passed from
	x11.trm was missing a space.  Bugfix.

2012-10-29  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c: Save axis scaling for 3D 'set view map' plots so
	that outboard drivers can continue mousing in -persist mode.

	* term/canvas.trm term/svg.trm: Sort out the up/down polarity of
	mousing limits in 3D 'set view map' plots. Bug #3581514

	* src/term.c src/term_api.h term/xlib.trm: Remove vestigial traces
	of ipc_back_fd outside of its scope (term.c).

	* term/debug.trm: Add entry points for filled_polygon, layer,
	set_color, path, image.

	* src/term.c src/gadgets.c src/set.c term/README:  Add a default
	routine null_set_font() so that code does not have to test every
	time whether the current terminal supports term->set_font() or not.

	* src/color.c src/color.h src/eval.c src/getcolor.c src/getcolor.h
	docs/gnuplot.doc:  
	New user-visible function hsv2rgb(H,S,V) creates a 24-bit RGB value
	from real H,S,V values in the range [0:1]. This allows use of hsv colors
	in plots with coloring style "rgb variable".  The new function can be
	used to implement the capability suggested by Shigeharu Takeno:
	  hsv(h,s,v) = sprintf("#%06x",hsv2rgb(h,s,v))
	  plot FOO lc rgb hsv(H,S,V)

	* demo/all.dem demo/complex_trig.dem demo/html/index.canvas
	demo/html/index.save demo/html/index.svg demo/html/Makefile
	demo/rgb_variable.dem:  Demos for HSV coloring, including a new demo
	for complex-valued trig functions.

2012-10-26  Ethan A Merritt  <merritt@u.washington.edu>

	* src/mouse.c src/mouse.h src/mousecmn.h src/term_api.h:  
	Allow the "bind" command to attach a user command to mouse button 1,
	at least for 2D plots.

2012-10-22  Ethan A Merritt  <merritt@u.washington.edu>

	* term/xlib.trm: Reset X11_ipc when xlib terminal exits; otherwise a
	subsequent "set term x11" fails to send output to gnuplot_x11.

	* term/x11.trm: Filter out redundant move/vector/set_color commands.
	- Do not send a Move or Vector command to gnuplot_x11 if the previous
	  move/vector went to the same coordinates.
	- Do not send an rgbcolor command to gnuplot_x11 if it duplicates the
	  previous rgbcolor command.
	Filtering yields a 9% reduction in the number of bytes sent from
	gnuplot to gnuplot_x11 during execution of all.dem.

2012-10-19  Ethan A Merritt  <merritt@u.washington.edu>

	* demo/html/webify.pl demo/html/webify_svg.pl demo/html/webify_canvas.pl:
	Add UTF-8 handling to web page generation.

	* src/command.c (do_string_and_free):  The "exit" command was not working
	inside a bracketed clause.  Bug #3576439

	* src/pm3d.c (pm3d_plot):  If pm3d option corners2color is 'mean' and
	the coloring option is 'rgb variable', then the code that calculates the
	mean must deal with alpha channel values as well as r/g/b components.

2012-10-19  Dima Kogan  <dima@secretsauce.net>

	* src/gplt_x11.c src/mouse.c term/x11.trm:
	Initialize x11 terminal aspect ratio so that it works for xlib also.

2012-10-16  Ethan A Merritt  <merritt@u.washington.edu>

	* term/lua.trm term/lua/gnuplot-tikz.lua:  The set_font() routine must
	update term->v_char and term->h_char. set_font("") must restore the
	default font. Bugfix.

	* src/term.c (term_start_multiplot): The calculation of vertical space
	required for a plot title depends on term->v_char, which in turn depends
	on the font used for the title. Bugfix.

	* term/gd.trm (set_font): The libgd terminals were failing to 
	notice a change in font size sent by set_term(",newsize")
	Bugfix (old bug!)

	* term/canvas.trm (set_font): Minimal set_font routine for canvas
	terminal.  All it does at this point is change or restore the font size.

2012-10-14  Dima Kogan  <dima@secretsauce.net>

	* src/gplt_x11.c: 
	With -replotonresize the resize triggered two replots, the initial
	outboard-only even-aspect-ratio one, and then the full replot.
	This fix skips the first of these.
	When the inboard driver is killed, the mouse-over coordinates were not
	computed correctly.  Bugfix.

2012-10-14  Ruediger Haertel  <haertel@users.sourceforge.net>

	* src/term.c (term_start_multiplot) docs/gnuplot.doc:
	Add enhanced/noenhanced option to "set multiplot title".

2012-10-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/qt_term.cpp (qt_set_font):  term->set_font("")
	must restore the default terminal font and size.
	Bugfix.

	* src/qtterminal/qt_term.cpp (qt_set_font qt_options):
	Make the current terminal font visible to the user.
	Update the font metrics whenever the font is changed.
	Bugfix.

	* demo/layout.dem: Modified to act as a test for the above bug fixes.

2012-10-12  Ethan A Merritt  <merritt@u.washington.edu>

	* term/svg.trm: Replace sizes given in points with sizes in user
	coordinates (nominally pixels = "px").  In empirical tests this makes
	the estimates generated for string width more accurate.  An alternative
	might be to give sizes in points multiplied by some internal variable
	that could be recalculated dynamically at display time.

	* term/svg.trm: Replace bundled style attributes with individual 
	specifications.  E.g.   
	    <g style="fill:none; stroke:rgb(0,0,0); font-size:10pt">
	becomes
	    <g fill="none" stroke="rgb(0,0,0)" font-size="10">

	* src/graph3d.c:  Suppress drawing of a degenerate keybox when
	"set key box" but no plot titles.  Bugfix.

	* src/graph3d.c src/show.c:  "set zlabel rotate parallel" should have
	the same effect as "set zlabel rotate".  Bugfix.

	* src/unset.c: `unset xrange` has done nothing but clear range_reverse.
	Make it also restore the default autoscaling and axis ranges.

2012-10-10  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/QtGnuplotWidget.cpp (exportToSvg):
	Restrict svg output size to scaled viewport.  This gets rid of the
	oversize border around a plot exported from the qt terminal to svg.
	Empirical fix, results not guaranteed!
	Bug #3573897

2012-10-09  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.h src/interpol.c src/plot2d.c docs/gnuplot.doc:
	Make the bandwidth parameter of "smooth kdensity" a constant specified 
	in the plot command rather than a per-data point variable.  The latter
	has no obvious physical meaning and anyhow is problematic because it
	overloads the meaning of the 3rd 'using' spec.  New syntax:
	    plot foo smooth kdensity {bandwidth <val>}
	If no value is given, or if the value in negative, use the calculated
	optimum bandwidth.  Store the value used in GPVAL_KDENSITY_BANDWIDTH.

	* src/term.h:  Remove regis from the default set of supported terminals

2012-10-08  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c (get_data) src/datafile.c (df_readascii) src/gp_types.h:
	Handle NaN pixels in image plots read in from non-matrix data.
	Handle NaN pixels in pm3d surfaces created by singularities in 
	harmonic mean.
	
	* src/pm3d.c (geomean4 harmean4 pm3d_plot): Revise geomean4():
	All corners positive => return positive geometric mean.
	All corners negative => return negative geometric mean.
	Otherwise return zero (previously the function returned something
	peculiar if 1 or 3 corners were negative).

2012-10-08  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wgraph.c (WndGraphProc): Implement space-raises-console
	for console mode gnuplot.

	* src/win/wtext.h (getchar): Make sure that getchar is defined.

	* src/term.c (test_term): Add newpath/closepath calls were applicable.

	* src/win/wpause.c: Include command.h for pause_for_mouse. (PauseBox): 
	Do not force pause-messagebox to stay on top. (WndPauseProc): "Cancel"
	button can be activated by escape key. Code cleanup.

	* term/win.trm (WIN_filled_polygon): Filled polygon are always closed.
	Ignore the last corner if it's the same as the first one.

	* src/plot.c (gnu_main) src/win/winmain.c (main): The Windows version
	used to handle the persist command line option in winmain.c. Moving
	it to plot.c ensures that the same options are supported on all
	platforms. See Bug #3538762

	* src/win/wcommon.h src/win/wtext.c (TextShow) src/win/winmain.h
	src/win/winmain.c (WinWindowOpened, WinPersistTextClose)
	src/win/wgraph.c (WndGraphProc) src/wxterminal/wx_term.h
	src/wxterminal/wxt_gui.h src/wxterminal/wxt_gui.cpp (~wxtFrame, 
	wxtFrame::onClose, wxt_window_opened, wxt_atexit) src/plot.c (main)
	Revise handling of persist mode on Windows: Exit wgnuplot only after the
	last plot window (wxt or win) has been closed. The text window is only
	shown if "-" is given on the command line. No zombie wgnuplot process
	when closing a persistent wxt terminal window. Console gnuplot behaviour
	stays unchanged.
	Bug #3538762

2012-10-05  Dima Kogan  <dima@secretsauce.net>

	* lisp/gnuplot.el: With this patch, emacs mode no longer pollutes
	global comint-mode-map. Instead it applies the key bindings only to
	the gnuplot comint instance.

2012-10-05  Vladimir  <lomov_vl@users.sourceforge.net>

	* src/lisp/Makefile.am: Fix typo in yesterday's revision.

2012-10-04  Clement Law  <themanifold@gmail.com>

	* src/pm3d.c src/pm3d.h src/set.c src/save.c src/show.c
	docs/gnuplot.doc demo/pm3d.dem:
	New option 'set pm3d corners2color harmean' (harmonic mean).

2012-10-04  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in prepare lisp/Makefile.am lisp/configure.in (removed):
	Simplify build scripts for the lisp files (a.k.a. emacs gnuplot-mode).

2012-10-01  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gplt_x11.c:  Replace parsing using sscanf( "%d %d" ) with
	two calls to strtol().  This yields a 2-fold speedup in benchmarks
	with large numbers of points and vectors.

2012-09-28  Dima Kogan  <dima@secretsauce.net>

	* src/gplt_x11.c src/gplt_x11.h:  Remove dead code.

	* src/gplt_x11.c term/x11.trm:  Modify format statements used to send
	commands from x11.trm to gnuplot_x11.  Before most integers were sent
	using "%04d", now " %d".  This prevents overflow for coordinate > 9999.
	The extra byte required for a 4-digit coordinate is compensated by 
	fewer bytes needed for small integers like linetype.

	* src/gplt_x11.c src/gplt_x11.h:  Adjust point size to accommodate
	changes in window size.

2012-09-26  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c src/util.c (streq) src/util.h:  New utility function
	streq(char *a, char *b) returns TRUE if a and b are identical save for
	leading and trailing whitespace.  Use this for matching requested string
	labels in a using spec to the actual column header text in a data file.
	Bug #3571243

2012-09-25  Dima Kogan  <dima@secretsauce.net>

	* src/gplt_x11.c src/mouse.c (do_event) term/x11.trm:
	Feed back the x11 window size from gnuplot_x11 to gnuplot so that
	the coordinates can be rescaled to maintain the correct aspect ratio.
	This allows correct functioning of commands like 'set size square' and
	'set view equal xyz' in an interactive x11 output window.

2012-09-24  Ethan A Merritt  <merritt@u.washington.edu>

	* demo/molecule.dem demo/datastrings.dem:  Remove old labelplot demo
	because it failed to show properly scaled xyz;  instead add equal xyz
	to molecule demo.

	* src/graphics.c docs/plotstyles.gnu:  Fix bug preventing explicit
	assignment of color sequence in stacked histograms.

2012-09-21  Ethan A Merritt  <merritt@u.washington.edu>

	* docs/Makefile.am lisp/Makefile.am lisp/configure.in:
	Fix breakage in "make distcheck".

2012-09-18  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c:  Incorrect default layout of rotated xtic labels.
	Bug #3568817

	* lisp/configure.in lisp/Makefile.am:  The autoconfigure scripting for
	the lisp directory is failing when $(EMACS) is redefined by the user.
	But the failure is only relevant to testing/patching info-look.el for
	very old versions of emacs.  Deal with it by simply assuming that
	everyone has an emacs version newer than 20.3 and therefore no patching
	is needed.

	* lisp/info-look.20.2.el lisp/info-look.20.3.el: No longer needed.

2012-09-16  Ethan A Merritt  <merritt@u.washington.edu>

	* src/set.c: set datafile separator {whitespace|tab|comma|"<char>"}

	* src/pm3d.c src/set.c src/color.c term/vgagl.trm src/term_api.h:
	The EXTENDED_COLOR_SPECS compile option is relevant only to one
	terminal (vgagl).  Make the corresponding toggle a terminal-specific
	flag rather than a global variable.  Clean up terminal flags.

	* src/axis.c src/axis.h src/mouse.c src/plot2d.c src/util.c:
	Allow zooming of plots that originally had an explicit range in the
	plot command.

	* src/set.c (set_label):  Simplify label parsing.

	* src/graphics.c (plot_filledcurves):  Use cliptorange() instead of
	simpler range check, since it handles reversed axes correctly.

2012-09-13  Ethan A Merritt  <merritt@u.washington.edu>

	* term/PostScript/prologue.ps term/post.trm:
	Handle transparent fill patterns in PS_fillbox() in the same way
	as is already done in PS_filled_polygon().
	Bug #3567035

	* src/eval.c (fill_gpval_axis) src/axis.h: The RANGE_REVERSE flag no
	longer exists, so do not report it to the user and do not swap axis
	min/max values when storing them for later mousing calculations by the
	canvas, svg, and other terminals.

	* src/datafile.c: Remove unused variables.

	* demo/html:  Update online demo collection to include linked axes
	and RGBA color applied to individual lines. 

2012-09-12  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/gnuplot-ja.doc docs/term-ja.diff man/gnuplot-ja.1:
	Sync with English documentation (rev.1.746).

2012-09-11  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c:  Index histogram stacks using the point's index rather
	than its x coordinate. Fixes rowstacked histogram array overflow.
	Bug #3566662

2012-09-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/tabulate.c:  Output a column for variable color if it is used 
	in the plot command.

2012-09-04  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* term/emf.trm:  Revise the object-handling code so that the current
	brush or pen is deselected before being deleted and recreated.
	Defer application of new dash+color line properties until needed for a
	new line segment.

2012-09-04  Ethan A Merritt  <merritt@u.washington.edu>

	* term/emf.trm: Seek to the beginning of the output file after plotting.
	If a user mistakenly tries to place two plots in the same file, the 
	second will cleanly overwrite the first rather than corrupting it.

2012-08-30  Ethan A Merritt  <merritt@u.washington.edu>

	* term/emf.trm (EMF_dashtype):  Fix incorrect mapping of requested
	linetype to the dash pattern.  Only LT_AXIS was properly mapped.

	* term/emf.trm (EMF_set_font):  (thanks to Shige Takeno) The intended
	optimization to prevent redundant requests for the same font was not
	implemented correctly.  This change fixes it so that a new font request
	is ignored if it would reapply the current font.

	* src/axis.h (STORE_WITH_LOG_AND_UPDATE_RANGE) src/plot2d.c:
	Optimize out the check for linked axes when the primary axis is
	COLOR_AXIS.  This avoids a compiler warning and also reduces the
	eventual code size.

2012-08-29  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.h (from Hans-Bernhard Broeker)
	#define AXIS_CLONE_SIZE offsetof(AXIS, linked_to_primary)

2012-08-27  Mojca Miklavec <mojca.miklavec.lists@gmail.com>

	* src/gp_types.h:  Remove superfluous comma from enum declaration.

2012-08-27  Ethan A Merritt  <merritt@u.washington.edu>

	* src/contour.c:  Invoke CheckZero() when automatically choosing contour
	levels.  The need for this check can be seen in contour.dem plots 19-21.

	* src/graph3d.c:  Rearrange code so that the plot key can be drawn in a
	separate pass ("set key opaque").

	* src/wxterminal/wxt_gui.cpp src/datafile.c term/emf.trm term/hpgl.trm:
	Trivial code cleanup to avoid compiler warnings (Sun or clang).

2012-08-24  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c:  Remove incorrect fall-back definition for MAXINT.
	Note:  ~0>>1  is _not_ guaranteed to shift a 0 into the high bit!

	* src/term.c src/unset.c src/term_api.h:
	Consistent with the documented generic meaning of "unset", the command
	"unset terminal" now restores the default terminal present at program
	entry.  I.e., it is equivalent to "set terminal GNUTERM".

	* src/graphics.c (do_key_layout): The height of opaque fill for the key
	box must be adjusted to allow for superscripts/subscripts in the title.
	Bug #3556892

	* docs/gnuplot.doc:
	- Add sections for "unset output" and "unset terminal".
	- Remove index entries for "set style <plotstyle>" since there is no
	  such command.
	- Bessel functions Jn and Yn by convention use a capital letter. 

2012-08-23  Thomas Gaillard <tgaillard@users.sourceforge.net>

	* src/interpol.c:  Mean and sigma of kernel density function were
	incorrectly calculated.
	Bug #3519563

2012-08-22  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c: In the code for drawing the key box and key samples,
	replace direct calls to term->move() and term->vector() with calls to
	clip_move() and clip_vector().
	Bug #3560531

	* src/plot2d.c src/plot3d.c:  Downgrade detection of a trailing comma
	in a plot command to a warning rather than an error.  This allows more
	convenient re-ordering of multi-line plot elements when replotting.

2012-08-14  Ethan A Merritt  <merritt@u.washington.edu>

	* lisp/gnuplot.el: elisp is now getting serious about a syntax change
	announced 10+ years ago.   s/(` (/`(/
	While here, clean out some old cruft from the directory.

2012-08-07  Mojca Miklavec <mojca.miklavec.lists@gmail.com>

	* term/aquaterm.trm:  Revised test for transparency support to match
	the implementation in AquaTerm version 1.1.1

2012-08-07  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c src/datafile.h src/plot2d.c src/tabulate.c:
	Blank lines separating datasets in an input file were stored as an
	UNDEFINED point but not otherwise marked. This patch introduces a
	recognizable (struct coordinate)blank_data_line that is stored when
	a blank line is encounted. This means that when writing the data back
	out via "set table" the separation between data sets can be maintained.
	Bug #3553151

2012-08-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c src/axis.h src/command.c src/command.h src/eval.c
	src/eval.h src/graphics.c src/mouse.c src/parse.c src/parse.h
	src/plot2d.c src/save.c src/set.c src/show.c src/tables.c src/tables.h
	src/unset.c term/canvas.trm:

	New command and functionality
	   set link [x2|y2] {via <expression1> inverse <expression2>}
	   unset link [x2|y2]
	This ties the range on the secondary axis to that of the primary axis.
	<expression1> maps the primary axis coordinates onto the secondary axis.
	<expression2> maps the secondary axis coordinates onto the primary axis.
	The optional mapping can be nonlinear. If x2/y2 tics are auto-generated,
	they will be labeled in the transformed coordinate system.
	Mouse tracking readout will also report the transformed coordinates.

	Note: Making the "linked_to_primary" option generic introduces compiler
	warnings from the code handling the colorbar axis, which in reality can
	never be linked.  These will be removed in a subsequent patchset.

 	* demo/TaBr.dem docs/gnuplot.doc:
	Documentation and demo files for the new command.

	* config/Makefile.am config/Makefile.in src/Makefile.am src/Makefile.in 
 	src/Makefile.maint src/os9.c: Remove mention of os9.c from Makefiles and
	remove os9.c itself from the distribution.

2012-08-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.h (STORE_WITH_LOG_AND_UPDATE_RANGE):  The fix of 
	2012-07-27 was not quite right (e.g. it broke electron.dem).

2012-08-03  Ethan A Merritt  <merritt@u.washington.edu>

	* term/pslatex.trm (EPSLATEX_set_color):  Some cairolatex set_color
	requests were being incorrectly ignored.
	Bug #3553940

	* src/plot2d.c:  Use coord_type rather than int where appropriate.

2012-08-02  Ethan A Merritt  <merritt@u.washington.edu>

	* term/canvas.trm term/svg.trm: Since we now support time to
	millisecond precision, the bounds of a time/date axis need to be
	written out using %.3f rather than %g.
	Bug #3548932

	* src/misc.c (load_file): The multiline bracketed clause handling adds
	trailing newlines to the input.  It is essential to check and extend the
	input buffer if needed before doing this.
	Bug #3549386

2012-07-27  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.h (STORE_WITH_LOG_AND_UPDATE_RANGE):  Auto-generated data was
	failing to plot the first and last points if the corresponding axis 
	range was inverted. E.g. plot [10:-10] '+' using 1:(sinc($1)) with lines
	The incorrect range check was introduced in the patch of 2012-03-09.
	Bugfix.

2012-07-24  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c (attach_title_to_plot): Limit "title at end" placement
	to the INRANGE portion of a plot.

2012-07-24  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wgraph.c (drawgraph):  Always use GDI calls only for
	printing. Do not mix with GDI+. This fixes printing of (transparent)
	filled polygons and boxes. Check if the printer driver can actually do
	transparency (AlphaBlend).
	See bug #3503318

2012-07-24  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/standard.c (f_asin, f_asinh): The patch of March 2011 got the
	overall sign wrong in the (x == 0.0) case.
	Bug #3542862

2012-07-23  Ethan A Merritt  <merritt@u.washington.edu>

	* term/js/gnuplot_mouse.js (mouse_update):  Allow for the possibility
	of mapping the x2 and y2 axis coordinates through plot-specific mapping
	functions gnuplot.x2_mapping(), gnuplot.y2_mapping() defined elsewhere.

2012-07-18  Ethan A Merritt  <merritt@u.washington.edu>

	* src/standard.c (f_acos): acos(x) was returning the complex conjugate
	of the correct result for complex input x with imag(x) > 0.
	Bug #3542862

	* src/parse.c (set_up_columnheader_parsing):  Take the column header 
	from the second using spec (normally the Y coordinate) to satisfy
	set key autotitle columnhead;  plot 'data' using "X":"Y"
	Bug #3542065

	* src/datafile.c (plot_option_using):  Track the appropriate column
	header when the column is specified via a non-string variable; e.g.
	plot for [i=1:N] 'data' using 1:(column(i))
	Bug #3542065

2012-07-18  Bastian Maerkisch  <bmaerkisch@web.de>

	* term/win.trm (WIN_options): Specifying only the font size (ie. ",8")
	would overwrite the font name with a bogus string. Bug fix.

	* config/config.oww config/config.nt config/config.mgw
	config/makefile.cyg config/makefile.unx config/cygwin/Makefile
	config/mingw/Makefile config/msvc/Makefile config/watcom/Makefile
	src/command.c src/winmain.c:
	Remove support for old style Windows help format.

	* src/win/wgnuplot.hpj: Removed.

2012-07-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/hidden3d.c (draw_edge): Fix broken tracking of top/bottom color
	distinction in hidden3d plots when the line colors are not specified in
	palette or RGB mode.
	Bugfix

2012-07-07  Ethan A Merritt  <merritt@u.washington.edu>

	* src/command.c (undefine_command): Allow "undefine $datablockname".

2012-07-07  Bastian Maerkisch  <bmaerkisch@web.de>

	* config/mingw/Makefile:  Extend use of VPATH which makes some explicit
	rules superfluous. Automatically create dependency .d files during
	build. Include current date in filenames of zip-file and installer for
	non-release builds. Remove long-unused WINDOWS variable.

2012-07-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/QtGnuplotScene.cpp (wheelEvent)
	src/wxterminal/wxt_gui.cpp (OnMouseWheel):
	Pass current mouse position in the structure for mouse wheel events.

2012-07-05  Thomas Orgis  <sobukus@users.sourceforge.net>

	* src/qtterminal/QtGnuplotApplication.cpp src/wxterminal/wxt_gui.cpp:
	The wxt and qt terminals handle -persist by continuing execution of a
	forked thread after the main thread has exited.  However, anyone waiting
	on the main thread won't see it as finished unless the stdout and 
	stderr streams inherited by the continuing process are closed.
	Bug #3309277

2012-07-04  Ethan A Merritt  <merritt@u.washington.edu>

	* src/pm3d.c (z2cb):  After "set log cb", z2cb(x) was returning 0 for
	x<=0 rather than -inf.  This causes it to be mistaken for the logged
	value of x=1.  Now we return CB_AXIS.min instead.
	Bug #3540048

2012-07-03  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c src/plot3d.c: do_3dplot() was called in three places,
	but only one correctly wrapped it in splot_map_{de}active().
	Move the activate/deactivate calls inside do_3dplot().
	Bug #3539459

	* src/qtterminal/QtGnuplotScene.cpp: Set Z value of zoom box to a large
	value so that it is not occluded by plot elements.

	* src/datafile.c (df_readascii): If the first line in a data file 
	contains column headers (strings to be used as titles), then that line
	should be ignored when applying the "plot ... every N:M(:N1:M1)" filter.
	Bug #3438848

2012-06-30  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/grpicon.ico:  Icon with more color depths and resolutions,
	derived from Mojca Miklavec's SVG icon, see patch #3469808.

	Store icons in CVS in binary format.
	* src/win/grpicon.ico src/win/texticon.ico:  New files.
	* config/cygwin/Makefile config/mingw/Makefile config/msvc/Makefile
	config/watcom/Makefile src/win/wgnuplot.rc:  Binary icons.
	* src/win/geticon.c:  Removed.

	* config/makefile.nt:  Superseded by msvc/Makefile. Removed.

	Eliminate some compiler warnings.
	* src/axis.c (load_one_range):  Make static and add prototype.
	* src/bitmap.c (b_boxfill):  Remove unused variable.
	* src/graphics.c (compare_ypoints, two_edge_intersect,
	hyperplane_between_points):  Prototypes.
	* src/plot.h (gnu_main):  Add prototype.
	* src/pm3d.c (pm3d_plot):  Unused variable.
	* src/stats.c (statsrequest):  Remove duplicate prototype.
	* src/util.c (utf8_getmore, utf8_strchrn):  Make static and add
	prototype.
	* src/win/winmain.c (gnu_main):  Remove incorrect prototype.
	* src/win/wmenu.c (SendMacro, LoadMacros):  Remove unused variables.
	* src/win/wpause.c (CreatePauseClass, win_sleep):  Include winmain.h.
	Prototypes. 
	* src/win/wprinter.c (PrintFind):  Add prototype and make static.
	* src/win/wtext.c (AboutDlgProc):  Prototype.
	* src/wxt/gpcairo.c (gp_cairo_convert, gp_cairo_create_layout):  Match
	prototypes.
	* src/wxt/wxt_gui.cpp (wxt_cairo_draw_hypertext):  Fix memory leak.

	* src/tables.c (num_predefined_colors):  Off by one.

	* src/win/wgdiplus.cpp (gdiplusCreatePen):  Use square line ends and
	miter line joins.

2012-06-29  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/gnuplot-ja.doc docs/term-ja.diff:
	Sync with English documentation (rev.1.741).

2012-06-29  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c (eval_plots):  Zero is often a special point in a
	function domain.  Make sure we don't miss it due to round-off error. 
	Bug #3519079

	* term/canvas.trm: ctx.fillText() uses fillStyle rather than strokeStyle

	* src/graphics.h src/graph3d.h src/graphics.c src/plot2d.c:
	New modifier for the `title` keyword in plot commands.
	`title ... at {beginning|end}` writes the plot title on the graph
	itself, immediately next to the corresponding plot. This is independent
	of the normal key.

	* docs/gnuplog.doc demo/nokey.dem demo/all.dem:
	Document new option and provide a demo.

2012-06-24  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c:  plot ... using "a":"b" was not setting the 
	parse_1st_row_as_headers flag.  Bug #3536514

2012-06-24  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wgraph.c (draw_new_pens) src/win/wgnuplib.h (struct GW)
	term/win.trm (WIN_options): Terminal option "rounded|butt".

2012-06-23  Bastian Maerkisch  <bmaerkisch@web.de>

	* demo/approximate.dem demo/cities.dem demo/enhanced-utf8.dem
	demo/epslatex.dem demo/fontfile.dem demo/fontfile_latex.dem
	demo/hypertext.dem demo/transparent.dem demo/utf8.dem:
	Restore original encoding.

	* src/set.c (set_encoding): Allow string valued variables as
	parameters.

2012-06-23  Jérôme lodewyck  <lodewyck@users.sourceforge.net>

	* configure.in src/Makefile.am src/qtterminal/qt_term.cpp
	src/qtterminal/qt_term_mac.m: Proper handling of the qt terminal dock
	icons on Mac OS

2012-06-19  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datablock.c src/datablock.h:  New files
	
	* src/command.c src/datafile.c src/eval.c src/fit.c src/gp_types.h
	src/Makefile.am src/misc.c src/parse.c src/scanner.c src/show.c
	src/stats.c src/tables.c:  Add support for named data blocks.

	* docs/gnuplot.doc demo/imageNaN.dem demo/heatmaps.dem:
	Document and provide demos for named data blocks.

	Example use of named data blocks:
	$Mydata << EOD
	1 2 3
	4 5 6
	EOD
	stats $Mydata using 1:2
	plot $Mydata using 1:2 with lines, $Mydata using 1:3 with impulse
	set print 'save.data'; print $Mydata

2012-06-15  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* docs/gnuplot.doc: Cleaned blank-only lines.

	* docs/Makefile.in: Regenerated.

	* docs/Makefile.am (BUILT_SOURCES): allterm.h belongs here.
	(doc2ms_DEPENDENCIES, doc2tex_DEPENDENDIES)
	(alldoc2gih_DEPENDENCIES): Removed allterm.h from these, since
	that would only cause it to be built at link time, which is too
	late.
	(check-local): Renamed from check, which would collide with
	automake's own definition.  Add missing $(EXEEXT) and ./
	(termdoc.$(OBJEXT)): Removed explicit dependency, since it would
	have made exactly the wrong builds depend on allterm.h.

2012-06-14  Ethan A Merritt  <merritt@u.washington.edu>

	* docs/Makefile.am: autoconf (2.68) does not automatically
	propagate dependencies for allterm.h. Add generic dependencies as
	documented, even though this still results in incorrect
	ordering. Fix it empirically by adding an explicit lower-level
	dependency at the end of the file.

2012-06-14  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* docs/Makefile.in: Regenerated.

	* docs/Makefile.am (gnuplot.ms, figures, gnuplot.tex)
	(gnuplot.hlp, gnuplot.gih, allgih, wxhelp/wgnuplot.html)
	(gnuplot.ipf, gnuplot.rtf, gnuplot.rnh): Targets running private
	executables lacked mandatory $(EXEEXT).  Caused direct build of,
	e.g. 'make pdf', to try and build the wrong program and fail.

2012-06-13  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c src/graph3d.h src/set.c src/show.c src/save.c
	src/unset.c src/plot3d.c src/gp_types.h src/tables.c src/graphics.c
	docs/gnuplot.doc:

	New command keywords "set surface {implicit|explicit}".
	Until now, splot has always added isolines to generate a gridded surface
	if an input data file looks like it contains lines along one direction
	of the grid.  This behavior corresponds to the "implicit" keyword and
	remains the default.  "set surface explicit" turns off the automatic
	generation of isolines, allowing such a data file to be plotted purely
	as unconnected lines rather than a generated grid.  You can still
	generate a gridded surface in this case by saying
	"plot ... with surface" rather than "plot ... with lines".

	Addresses tracker item #1244775 (Theo Hopman)

2012-06-13  Bastian Maerkisch  <bmaerkisch@web.de>

	* config/config.mgw config/config.nt src/win/wtext.h:  Move preprocessor
	defines for fake pipe support to wtext.h in order to avoid redefinition
	warnings.

	* config/mingw/Makefile config/msvc/Makefile:  Include
	templates for initialization files in distribution.

	* src/win/wgraph.c (drawgraph): Do not try to detect color capabilities
	of printers. When drawing to a printer, scale line widths to match the
	widths on screen and fix placement of super- and subscripts.
	Bug #3503318

2012-06-12  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c (df_readascii):  Bugfix for label plots using column 0
	to generate text. E.g. plot foo using 1:2:(sprintf("%d",$0)) with labels

2012-06-09  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/fit.c (setvar):  Accept a double value instead of struct value.
	Use fill_gpval_float. Simplify callers.

	* src/fit.c (getivar, getdvar, creatdvar):  Use get_udv_by_name() or
	add_udv_by_name().

	* src/fit.c (fit_command):  Always initialize variables which might be
	set by user variables. This is necessary since user variables may be
	`undefine`d.

	* src/eval.c (real_int):  New function to retrieve an integer value
	from a user variable.

2012-06-07  Ethan A Merritt  <merritt@u.washington.edu>

	* src/tabulate.c:  Allow tabulation (set table) of pixel values for
	IMAGE RGBIMAGE RGBA_IMAGE.

2012-06-01  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c (box_range_fiddling):
	Autoscaling + auto-boxwidth + log scale on x = fail.
	Bug #3529285

2012-05-30  Ethan A Merritt  <merritt@u.washington.edu>

	* term/pslatex.trm: More helpful error message if output filename
	is not acceptable.
	Bug #3529832

	* src/interpol.c (cp_implode): This routine was not preserving the z
	value (used as a weight by smooth acsplines) of input data points.
	Bug #3529621

	* src/plot2d.c (get_data) docs/gnuplot.doc:  Use unit weights for
	"smooth acsplines" if no separate column of weights is provided.

2012-05-25  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* docs/Makefile.am (gnuplot.ms, figures, gnuplot.tex)
	(gnuplot.hlp, gnuplot.gih, allgih, gnuplot.texi, gnuplot.ipf)
	(gnuplot.rtf, check): Re-enable out-of-source-tree builds.
	(doc2ms_SOURCES): Remove duplicate source file.
	(doc2ms): Remove rule that would conflict with automake generated
	one.

2012-05-24  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wgraph.c: Recreate fonts after resizing the graph window.
	Fixes side effects of changes on 2012-05-20.

2012-05-23  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wgraph.c src/win/wgnuplib.h term/win.trm: Support for
	hypertext labels for win terminal.

	* src/win/wgdiplus.c|h src/wgraph.c term/win.trm: rgba colors.
	Restricted to GDI+ and thus currently only available when using
	antialiasing.

2012-05-21  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term_api.h: Core support for hypertext in interactive
	terminals.  Terminal entry term->hypertext(int TYPE, const char
	TEXT) associates a hypertext string with some subsequent graphics
	object.  The effect of this association depends on TYPE.
	Initially only type HYPERTEXT_TOOLTIP is implemented.  This causes
	the text string to be displayed in a tooltip-like popup when the
	mouse hovers over the associated graphics element.

	* src/gadgets.c src/gadgets.h src/set.c src/show.c: New keyword
	"hypertext" associated with individual labels, including plot
	style "with labels".  The label text is displayed only when the
	mouse hovers over the associated anchor point.

	* term/README docs/gnuplot.doc demo/hypertext.dem: Documentation
	and demo

	* term/canvas.trm term/js/gnuplot_mouse.js: Support for canvas
	terminal.

	* src/qtterminal/QtGnuplotEvent.h
	src/qtterminal/QtGnuplotScene.cpp src/qtterminal/QtGnuplotScene.h
	src/qtterminal/qt_term.cpp src/qtterminal/qt_term.h term/qt.trm:
	Support for qt terminal.

	* term/svg.trm term/js/gnuplot_svg.js: Support for svg terminal.

	* src/wxterminal/gp_cairo.c src/wxterminal/gp_cairo.h
	src/wxterminal/wxt_gui.cpp src/wxterminal/wxt_gui.h
	src/wxterminal/wxt_term.h term/cairo.trm term/wxt.trm: Support for
	wxt terminal.

2012-05-20  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in docs/Makefile.am: Updated a patch from Christoph
	Junghans to use autoconf to manage the documentation subdirectory.
	The primary reason is to allow --without-lisp-files to control
	whether or not the build process tries to access emacs-specific
	directories and files that may not be present.  Bugs #2950671
	#3528377

2012-05-20  Alexander Täschner  <taschna@users.sourceforge.net>

	* src/fit.c|h (regress)
	* src/save.c (save_set_all)
	* src/set.c (set_fit)
	* src/show.c (show_fit)
	* src/unset.c (unset_fit)
	* docs/gnuplot.doc: New option "set fit [no]errorscaling" which
	allows to toggle scaling of parameter errors. The default remains
	to scale errors.  Patch #3375473, Feature Request #2956524.

2012-05-20  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/wcommon.h src/win/wgnuplib.h src/win/wgraph.c: Remove
	limit on number of plots which can be toggled on/off via key
	entries.  Maximum number of toolbar buttons still restricted to
	MAXPLOTSHIDE.  Bug #3516417

	* demo/image2.dem: Meaning of "set [xyz]range reverse" changed.

	* term/win.trm (WIN_options, WIN_set_color) src/win/wgraph.c
	(drawgraph): Change the behaviour of the "mono" terminal option of
	the windows terminal. Colors are converted from RGB to grayscale in
	drawgraph(). That way, a grayscale copy of colour plots can be
	obtained more easily.

	* src/win/wgnuplib.h src/win/wgraph.c: Retain the temporary bitmap used
	for drawing to speed up redraws. Reduces the number of calls to
	drawgraph() to a minimum.

2012-05-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c (do_arc) src/graphics.c (do_ellipse):  Revisit clipping the
	filled interior of circles and ellipses.  Now it handles objects whose
	center is outside the plot but specified in plot coordinates.
	Bug #3522515

2012-05-17  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/faq-ja.tex docs/gnuplot-ja.doc docs/term-ja.diff
	man/gnuplot-ja.1:  Sync with English documentation.

2012-05-13  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c (do_arc) src/graphics.c (do_ellipse):  Clip the filled
	interior of circles and ellipses.
	Bug #3522515

2012-05-11  Ethan A Merritt  <merritt@u.washington.edu>

	* src/wxterminal/wxt_gui.cpp (wxt_cairo_refresh):  Execution of the
	command list must be protected by command_list_mutex or it will blow up
	if the command list is cleared/replaced during execution.
	Bug #3371205

	* src/graphics.c:  Allow log-scaled y axis for plots with fillsteps.
	Bug #3324785

2012-05-10  Ethan A Merritt  <merritt@u.washington.edu>

	* src/misc.c (lf_push lf_pop) src/misc.h:  The lf_push/lf_pop mechanism
	for restoring context after a "call" statement was saving the individual
	call args $0 $1 etc, but failing to save the number of active args.
	Bug #3525155

2012-05-09  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c (plot_option_array): Skip call to clear_binary_records.
	This reduces the order-dependence of binary plot options, but may intro-
	duce some persistence of options across plot commands.
	Bug #3408082

2012-05-07  Ethan A Merritt  <merritt@u.washington.edu>

	* term/cairo.trm term/pslatex.trm: Fix 'set term cairolatex pdf mono'
	Bug-Debian: http://bugs.debian.org/668339

	* src/graph3d.c (key_sample_line_pm3d key_sample_point_pm3d):
	If the color scheme is "lc variable", take the color of key sample from
	the first point in the data set.

2012-05-06  Anton Gladky <gladky.anton@gmail.com>

	* src/command.c: Fix segfault in initial check of history when using
	--with-readline=bsd
	Bug-Debian: http://bugs.debian.org/665832

	* src/plot.c: EAM - avoid calling buggy libedit emulation of
	using_history().
	Bug-Debian: http://bugs.debian.org/598547

2012-05-05  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c term/estimate.trm:  Rename utf8_strlen to utf8_strwidth
	to avoid name collision.

	* src/internal.c (f_strlen f_range) src/util.c (strlen_utf8 gp_strlen)
	(utf8_strchrn gp_strchrn) src/util.h:  Fix gnuplot's user-visible
	string handling routines strlen() and substr() so that they handle
	multibyte UTF-8 characters correctly.  I.e. strlen() returns the number
	of characters, not the number of bytes.  Other multi-byte encodings are
	not handled, however.
	Bug #3480075

2012-05-04  Ethan A Merritt  <merritt@u.washington.edu>

	* CodeStyle config/Makefile.am.in configure.in demo/Makefile.am.in
	 lisp/Makefile.am m4/Makefile.am.in Makefile.am man/Makefile.am
	 share/LaTeX/Makefile.am share/Makefile.am src/Makefile.am
	 src/qtterminal/Makefile.am src/version.c src/wxterminal/Makefile.am
	 term/Makefile.am.in tutorial/Makefile.am.in:

	 Automake 1.12 removes support for the AM_C_PROTOTYPES macro and for
	 conversion of ANSI C code to K&R C code.  Gnuplot's CodeStyle file has
	 warned since version 3.7 that gnuplot would drop support for ansi2knr
	 "very soon".  Now 12+ years later the other shoe has dropped.
	 
	 This set of changes removes reference to AM_C_PROTOTYPES and ansi2knr
	 in the autoconf files, replacing it with an unconditional
	 AC_DEFINE(PROTOTYPES,1) so that the existing source code stays happy.
	 The individual config.* files and the source code itself can be cleaned
	 up later to remove the need for this definition.

	* src/ansi2knr.1 src/ansi2knr.c src/ansichek.h: Remove these.

	* src/set.c(set_command) src/command.c(do_command):  Test for empty
	iteration loop in "set for ..." and "do for ..." commands.

2012-05-03  Ethan A Merritt  <merritt@u.washington.edu>

	* term/js/canvasmath.js term/js/gnuplot_common.js term/js/gnuplot_svg.js
	term/js/gnuplot_dashedlines.js term/js/gnuplot_mouse.js:
	Reduce the scope of local variables.

2012-05-02  Arun Persaud  <arun@nubati.net>

	* term/svg.trm:  Remove trailing whitespace from output svg files.

2012-05-02  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c (df_readascii):  CHANGE long-standing program action to
	check every input data line individually for number of data columns.
	Instead, whatever number of columns are found in the first record, that
	same number is expected for the rest of the input file.
	This is not ideal, because plot 'foo' with points will now fail if 'foo'
	has 4 or more entries on the first line but only 3 on subsequent lines.
	On the other hand, it fixes the unexpected behavior that
	    3 NaN
	in record 5, for example, would be treated as (5,3) DEFINED
	rather than as (3,NaN) UNDEFINED.

	* docs/gnuplot.doc docs/figure_missing.pdf:  Documentation and example
	for above change.

2012-04-30  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c (do_arc):  A bug in the new wedge/nowedge option left a
	gap in the perimeter of some circles.
	Bug #3522503

	* term/wxt.trm:  Add a linewidth option to the wxt terminal.

2012-04-27  Ethan A Merritt  <merritt@u.washington.edu>

	* term/svg.trm:  Prevent illegal characters from being generated as 
	subplot ids if there are more than 30 subplots in a multiplot.

2012-04-26  Jon Oddie  <joddie@users.sourceforge.net>

	* docs/doc2texi.c: Two bug fixes
	Cleaner code to determine which term files to read in d2t-get-terminals.
	Fix code for uniquifying duplicate node names.

	* configure.in docs/Makefile.in docs/doc2texi.c:
	Create an Emacs Lisp file of documentation strings extracted from the
	syntax descriptions in gnuplot.doc. Gnuplot-mode can then optionally
	display these strings as automatic one-line documentation while editing,
	and pop up the full syntax description on request

2012-04-26  Ethan A Merritt  <merritt@u.washington.edu>

	* term/svg.trm:  Write out coordinates to the precision implied by
	SVG_SCALE.

	* src/set.c: Fix incorrect test for error return from iconv().

2012-04-24  Mojca Miklavec <mojca.miklavec.lists@gmail.com>

	* term/aquaterm.trm:  Clip images to bounding box. Reset line type
	at the start of each plot.

2012-04-23  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in m4/apple.m4:  Add a configuration option for aquaterm.
	The default is --without-aquaterm, select using --with-aquaterm.

2012-04-20  Ethan A Merritt  <merritt@u.washington.edu>

	* term/aquaterm.trm: rgba colors

2012-04-18  Ethan A Merritt  <merritt@u.washington.edu>

	* term/js/canvasmath.js (measure): Correct width of composite characters

	* term/svg.trm: The svg code refers to CANVAS_OVERSAMPLE when it should
	refer to SVG_SCALE.  Fortunately they both equal 10.

2012-04-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/misc.c (load_file):  If the input file did not end in a newline,
	the test for balanced {} occurred too early, causing a false error if
	the final partial line did in fact contain the required }.
	Bug #3518476

	* src/command.c src/datafile.c src/graph3d.c src/graphics.c
	src/hidden3d.c src/mouse.c src/util3d.c:
	Remove dead code.

	* config/config.nt config/config.os2 config/config.oww config/config.mgw
	config/config.cyg config/config.dj2 config/config.wc src/parse.c
	src/plot2d.c src/plot3d.c src/show.c src/eval.c src/set.c:
	Remove the --enable-backwards-compatibility configuration option.
	The deprecation warning has been in the documentation since version 4.0
	and it wasn't working in recent versions anyhow.

2012-04-12  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in term/gd.trm:  We no longer claim to support libgd 
	versions older than 2.0

	* docs/gnuplot.doc:  Clear out the New Features section, which should
	now cover stuff added since 4.6

	* src/color.c (set_rgbcolor) src/color.h src/graph3d.c src/hidden3d.c:
	In order to read and store a 32-bit AlphaRGB value it must be treated
	as (unsigned int) rather than (int).

	* term/cairo.trm term/canvas.trm term/gd.trm term/svg.trm 
	src/qtterminal/QtGnuplotScene.cpp src/qtterminal/qt_term.cpp
	src/wxterminal/gp_cairo.c src/wxterminal/gp_cairo.h
	src/wxterminal/wxt_gui.cpp demo/rgba_lines.dem:
	Carry along all 32 bits of an input RGB value, so that the high bits
	can hold an alpha channel.  In order for existing RGB colors to stay
	opaque, this means that alpha=0 is opaque and alpha=255 is transparent.
	>>> Note: this convention is the inverse of the current treatment
	>>>       of the alpha channel in "with rgbimage".

2012-04-10  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.c (df_readbinary):  NaN treatment tested the wrong flag
	(df_matrix_file rather than df_matrix).

2012-04-08  Ethan A Merritt  <merritt@u.washington.edu>

	* src/misc.c (iso_alloc iso_extend):  Initialize each 3D coordinate
	structure on allocation.  Fixes problems found by valgrind and easily
	seen by running imageNaN.dem.

	* src/datafile.c src/graphics.c demo/imageNaN.dem demo/all.dem:
	Revised treatment of NaN in the input data stream.
	1) Mark NaN points as DF_UNDEFINED on input. This is a CHANGE. Ascii NaN
	was either reported as DF_BAD or ignored altogether depended on context;
	binary NaN was not handled at all, leading to possible segfaults.
	2) Treat NaN in non-coordinate data columns in the same way as NaN in a
	coordinate.
	Bug #3513138 and various problems visible by running imageNaN.dem

2012-04-03  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c (copy_or_invent_formatstring):  Expansion to many decimal
	places of precision is not necessary if the axis range spans 0, because
	in that case exponential notation can be used instead.
	Bug #3514604

2012-04-01  Hannes Nagel  <hannes.nagel@itp.uni-leipzig.de>

	* term/lua.term: Do not create external png images if they are not 
	going to be used in the tex document.

2012-04-01  Jérôme Lodewyck  <lodewyck@users.sourceforge.net>

	* src/qtterminal/QtGnuplotWidget.h src/qtterminal/QtGnuplotWidget.cpp:
	Fixes fom Mojca Miklavec: correct page size in the PDF export and always
	turn on text antialiasing

2012-03-31  Ethan A Merritt  <merritt@u.washington.edu>

	* src/pm3d.c term/post.trm term/pslatex.trm src/term_api.h src/color.c:
	The core code should not write terminal-specific output.  Instead define
	TERM_LAYER_BEGIN_PM3D_MAP and TERM_LAYER_END_PM3D_MAP and use the 
	term->layer() mechanism.  This prevents garbage from being written out
	to the cairolatex terminals in pm3d mode.
	Bug #3513291

2012-03-29  Ethan A Merritt  <merritt@u.washington.edu>

	* src/wxterminal/gp_cairo.c (gp_cairo_draw_polygon): Always stroke
	previous path before starting a new polygon.  Also, dots are slow.
	Only draw them if specifically requested.
	Bug #3512955

2012-03-26  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c (enhanced_recursion): Revised handling of backslash
	character in enhanced text processing.
	Bug #3496517

2012-03-24  Ethan A Merritt  <merritt@u.washington.edu>

	* term/js/canvasmath.js:  Handle tab and newline.

2012-03-20  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c src/plot2d.h:  Allow variable pointsize in label plots.

	* term/canvas.trm:  Push the correction for over-sampling of Pt
	coordinates down one level so it matches the other graphics item types.

	* src/unset.c:  "reset" must clear range_is_reverted flag for all axes.

2012-03-18  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.c (gen_tics): Be even more paranoid about precision error in
	axis range or tic steps.

	* src/set.c: Sanity checking on requested number of minitic intervals.

2012-03-18  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/gplt_x11.c (exec_cmd): Don't feed unknown strings directly
	to *printf.

	* src/plot3d.c (eval_3dplots): Don't mix up enums JUSTIFY and
	VERT_JUSTIFY.

	* src/plot2d.c (eval_plots): Don't mix up enums JUSTIFY and
	VERT_JUSTIFY.

	* src/graphics.c (do_plot): Don't mix up enums JUSTIFY and
	VERT_JUSTIFY.

	* src/color.c (cbtick_callback): Don't mix up enums JUSTIFY and
	VERT_JUSTIFY.

2012-03-16  Ethan A Merritt  <merritt@u.washington.edu>

	* term/post.trm term/svg.trm:
	Do not allow execution of popen() commands during initialization.

2012-03-13  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gadgets.h src/graphics.c src/save.c src/set.c src/show.c
	src/term.c src/term_api.h docs/gnuplot.doc:
	New option "set style circle {no}wedges"

2012-03-13  Michael Reeves  <mgreeves@users.sourceforge.net>

	* src/graphics.c: Improved calculation of the margin space needed to
	hold rotated x and x2 tic labels.
	Bug #3482491

2012-03-12 Bastian Maerkisch  <bmaerkisch@web.de>

	* win/gnuplot.iss: Bump version number of installer to 4.7.

	* config/mingw/Makefile: New target 'zip' for zip file distribution.

2012-03-09  Ethan A Merritt  <merritt@u.washington.edu>

	* src/axis.h src/graphics3d.c src/util3d.c:
	Preparatory cleanup for re-working of axis reverse and range check
	processing.  This change reduces the size of code produced by macro 
	STORE_WITH_LOG_AND_UPDATE_RANGE (called >50 times)
	but does not change the runtime behavior of the program.

	* src/axis.c src/axis.h src/command.c src/gadgets.h src/mouse.c 
	src/mouse.h src/plot2d.c src/plot3d.c src/save.c src/set.c src/unset.c
	docs/gnuplot.doc:
	Change the handling of "set [xyz]range reverse".
	Get rid of flag RANGE_REVERSE.  Axis range endpoints are now always
	stored as-is (i.e. XAXIS.min is not guaranteed to be numerically less
	than XAXIS.max).  The user command "set [xyz]range ... reverse" now
	only affects auto-scaling. This is a change in behavior, although it
	matches what the documentation has always given as the intended use.
	Fixes various bugs and unexpected behavior; e.g.
	"set xr [1:0]; set xr [0:1];" left the axis range reversed.

2012-03-09  BUMP DEVELOPMENT VERSION NUMBER TO 4.7

2012-03-09  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c: Odd corner-case of histograms + "set style incr user".
	Bug #3499425

2012-03-03  Petr Mikulik  <mikulik@physics.muni.cz>

	* docs/doc2ipf.c (process_line): Don't use assert() because it calls
	int_error().

2012-03-02  Petr Mikulik  <mikulik@physics.muni.cz>

	* config/makefile.os2: version.o is required for gnuplot_x11.exe.

2012-03-02  Ethan A Merritt  <merritt@u.washington.edu>

	* docs/gnuplot.doc:  Point to www.gnuplot.info as the URL for all demos.
	
	* configure.in src/plot.c src/version.c src/show.c config/mingw/Makefile:
	Mark this explicitly as a DEVELOPMENT_VERSION at configuration time
	rather than hiding or providing a RELEASE_VERSION definition in
	individual source files.

2012-03-01  Ethan A Merritt  <merritt@u.washington.edu>

	* README README.1ST INSTALL TODO FAQ.pdf:  Update text for version 4.6

2012-02-29  Mojca Miklavec <mojca.miklavec.lists@gmail.com>

	* src/wxterminal/wxt_gui.cpp (OnMouseWheel): wxWidgets 2.9 supports 
	horizontal mouse scrolling.

2012-02-25  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in tutorial/tutorial.tex:  Update latex tutorial for version
	4.6 but do not install it by default.

2012-02-25  Peter Juhasz  <juhaszp@users.sourceforge.net>

	* src/command.c src/misc.c src/plot.c src/plot.h:
	Unterminated blocks (i.e. missing }) in batch mode caused the program to
	erroneously wait for further input or - when commands were streamed
	through a pipe - crash. Fix: display an appropriate error message instead.
	Bug #3491904

2012-02-22  Ethan A Merritt  <merritt@u.washington.edu>

	* src/stats.c: Remove order-dependence of keywords.
	Bug #3491215

2012-02-21  contributed anonymously

	* src/term.c (do_arc): Arcs smaller than 3 degrees were being
	reduced to a single line.  Bug #3490227.

2012-02-19  David Leverton  <dleverton@users.sourceforge.net>
	
	* src/graphics.c (edge_intersect):  Fix a bug that failed to draw a
	pure horizontal or vertical from out of range that crossed the entire
	range of a plot to terminate on the boundary.
	Bug #3488666

2012-02-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c src/graphics.c:  The histogram code was not designed to 
	mix well with other plot styles, and in particular with function plots.
	Fixes segfault on "plot 1, newhistogram illegal-syntax, foo".
	Fixes Bug #3486639 (key entry spacing of histograms + something else)

2012-02-08  Jérôme Lodewyck  <lodewyck@users.sourceforge.net>

	* src/qtterminal/QtGnuplotItems.h src/qtterminal/QtGnuplotItems.cpp:
	Fixed the const-ness of QtGnuplotKeybox members.

2012-02-06  Thanate Dhirasakdanon  <dthanate@users.sourceforge.net>

	* term/lua.trm: Compatibility wrapper functions to support both lua 5.2
	and earlier versions.

	* term/lua/gnuplot-tikz.lua: fix tightboundingbox option

2012-02-06  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c: Remove error test that could not be reached in the DATA
	case and is incorrect in the FUNC case.

2012-01-30  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c term/linux.trm:  Provide a 5x9 raster font for linux.trm
	and svga.trm so that they are not dependent on --with-bitmap-terminals.
	Bug #3481336

2012-01-29  Ethan A Merritt  <merritt@u.washington.edu>

	* term/cairo.trm:  Make the font scale handling more like pdf and eps.
	Bugs #3478745 #3480006

2012-01-26  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graphics.c:  If there is no key title, there is no need to draw a
	line between the title and the key samples.
	Bug #3478984

	* docs/gnuplot.doc:  Clarify that strlen returns string length in bytes,
	not characters.

2012-01-21  Ethan A Merritt  <merritt@u.washington.edu>

	* src/datafile.h src/datafile.c src/plot2d.c src/breaders.c src/plot3d.c
	src/stats.c:  When reporting bad data in an input file, give the file
	name in addition to the current line number.

	* term/wxt.trm src/term_api.h src/term.c src/qtterminal/qt_term.cpp
	src/wxterminal/wxt_gui.cpp:  Switching the terminal from qt to wxt or
	vice versa causes the program to lock up or segfault.  Introduce a flag
	terminal_interlock to prevent such a switch.

2012-01-19  Khanh-Dang  <kdntl@users.sourceforge.net>

	* gplt_x11.c (gpXStoreName):  Provide a name string for both
	WM_NAME and WM_ICON_NAME.

2012-01-17  Jérôme Lodewyck <lodewyck@users.sourceforge.net>

	* configure.in src/Makefile.am src/qtterminal/Makefile.am
	src/qtterminal/QtGnuplotApplication.cpp
	src/qtterminal/QtGnuplotApplication.h src/qtterminal/QtGnuplotEvent.cpp
	src/qtterminal/QtGnuplotEvent.h src/qtterminal/gnuplot_qt.cpp
	src/qtterminal/qt_term.cpp term/qt.trm: The Qt terminal application is
	executed in a separate executable called gnuplot_qt, started by exec.
	This makes the Qt terminal compatible with OS X.

2012-01-17  Ethan A Merritt  <merritt@u.washington.edu>

	* src/eval.c (update_plot_bounds):  Store the canvas size used by
	the previous plot in user accessible variables GPVAL_TERM_XSIZE,
	GPVAL_TERM_YSIZE.

2012-01-15  Mojca Miklavec <mojca.miklavec.lists@gmail.com>

	* src/mouse.c (event_buttonpress): Treat mouse buttons 6/7 as
	left/right scroll events (e.g. from fingers on a touchpad).

	* src/qtterminal/QtGnuplotScene.cpp (mouseReleaseEvent):  Pass
	horizontal scroll events through to gnuplot core as mouse events
	6/7.

2012-01-15 Bastian Maerkisch  <bmaerkisch@web.de>

	* config/config.mgw: Sync with configure.

2012-01-14  Bastian Maerkisch  <bmaerkisch@web.de>

	* tutorial/linepoin.plt: Avoid deprecated syntax.

	* win/gnuplot.iss: Create startup menu item for tutorial.pdf.

	* config/mingw/Makefile config/msvc/Makefile src/plot.c:
	GNUPLOT_SHARE_DIR is relative to gnuplot directory on Windows.
	Extend build support for documentation, include in installer.

2012-01-12  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* win/gnuplot.iss: Japanese translation

2012-01-11  Ethan A Merritt  <merritt@u.washington.edu>

	* src/util3d.h src/util3d.c (edge3d_intersect two_edge3d_intersect) 
	src/graph3d.c (plot3d_lines_pm3d):  The utility routines in util3d
	assumed that a 3D curve is always traversed in ascending order of the
	constituent points.  But plot3d_lines_pm3d scans in both directions,
	leading to incorrect clipping and possible array over-run when the
	utility routines were called.  Furthermore, the arrays holding the
	scan direction info were never initialized.
	Bug #3471163

2012-01-09  Ethan A Merritt  <merritt@u.washington.edu>

	* docs/Makefile.in src/term.h src/makefile.awc src/Makefile.all
	term/mac.trm:
	Remove vestigial terminal wrapper (contents are long gone).

2012-01-08  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot.c:  Allow shell commands from ~/.gnuplot but not from shared
	initialization files.

	* configure.in: Report status of aquaterm configuration correctly
	(Lutz Maibaum).

2012-01-07  Ethan A Merritt  <merritt@u.washington.edu>

	* src/misc.c (lf_pop): If the current input stream from "load file" is
	really a pipe, close it with pclose() rather than fclose().
	Bug #3470351

2012-01-07  Jérôme Lodewyck <lodewyck@users.sourceforge.net>

	* src/qtterminal/QtGnuplotScene.cpp: Normalize the zoom rectangle to avoid
	redrawing artifacts

2012-01-05  Ethan A Merritt  <merritt@u.washington.edu>

	* configure.in src/Makefile.am: Tweak autodetection of Qt utilities to
	handle differences in the Qt 4.6 and 4.7 pkg-config files.

	* src/set.c: Call gp_expand_tilde() in 'set loadpath' and 'set fontpath'.

2012-01-04  Colin Macdonald  <macdonald@maths.ox.ac.uk>

	* src/gplt_x11.c: Set WM_CLASS to "Gnuplot" for the benefit of various
	window managers.

2012-01-04  Ethan A Merritt  <merritt@u.washington.edu>

	* src/hidden3d.c: Fix an uninitialized colorspec found by valgrind.
	The trigger was hidden3d handling of '... with labels tc palette'.

2012-01-02  Ethan A Merritt  <merritt@u.washington.edu>

	* docs/gnuplot.doc src/graphics.c:  Establish a documented clipping
	behavior for rectangles - clip to fit in the graph unless one or both
	corners are given in screen coordinates.

2012-01-01  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/QtGnuplotApplication.cpp (processEvent):
	* src/wxterminal/wxt_gui.cpp (wxt_atexit):
	In "persist" mode, if all qt plot windows were already closed when the
	main program exited then the daughter process would become a zombie.
	Even worse for wxt; if _any_ plot windows had been closed then the 
	persisting daughter process would become a zombie.
	Bugfix.

2011-12-29  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot.c src/plot.h src/qtterminal/qt_term.cpp:
	Provide a function cancel_history() that can be called by terminal
	helper functions after forking so that the history file isn't 
	trashed on exit.
	Bug #2950711

2011-12-28  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/QtGnuplotEvent.h src/qtterminal/QtGnuplotItems.cpp
 	src/qtterminal/QtGnuplotItems.h src/qtterminal/QtGnuplotScene.cpp
 	src/qtterminal/QtGnuplotScene.h src/qtterminal/qt_term.cpp term/qt.trm:

	Organize Qt display list items into groups, one group per plot.
	Track display area of keybox entries so that mouse clicks there can
	toggle the visibility of the corresponding plot group.
	NB: Doesn't work if the key box is set to opaque.

	* docs/gnuplot.doc share/Makefile.am share/colors_default.gp
	share/colors_mono.gp share/colors_podo.gp share/gnuplotrc
	src/Makefile.am:
	Provide template initialization files, including examples of customizing
	the linetype color sequence.  These are installed in $GNUPLOT_SHARE_DIR.

	* src/command.c src/datafile.c src/help.c src/history.c src/misc.c
	src/plot.c src/plot.h src/term.c src/variable.c:
	Do not allow execution of system(), shell, or popen() commands in the
	initialization files.

	* src/plot.c src/show.c: More compact splash page.

	* configure.in: Default to --enable-stats --without-bitmap-terminals

	* Remove obsolete interface shim intergraph.x11

	* src/graphics.c src/graphics.h src/graph3d.c:
	Strangely, the final parameter of place_objects(,,,clip_area) was
	(1) never used and (2) shadowed a global parameter that _was_ used.
	Bug #3426247

2011-12-25  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/QtGnuplotEvent.cpp src/qtterminal/QtGnuplotScene.cpp:
	If two button release events occur in quick succession then the program
	messes up the event handling and winds up in a non-recoverable state.
	Apply an empirical fix to ignore events in a 300 msec window.
	Also rather than ending up a zombie, exit explicitly on a sync error.
	Bugfix

2011-12-23  Ethan A Merritt  <merritt@u.washington.edu>

	* QtGnuplotEvent.h QtGnuplotScene.cpp QtGnuplotWidget.h qt_term.cpp:
	Support LT_BACKGROUND in qt terminal.

	* src/wxterminal/wxt_gui.cpp:
	Revised mechanism for toggling plots on/off.

2011-12-23  Bastian Maerkisch  <bmaerkisch@web.de>

	Installer for Windows. Japanese translation by Shigeharu Takeno.

	* win/gnuplot.iss win/modpath.iss: Installer script to be compiled by
	Inno Setup. New files.

	* win/Copyright-ja.txt: Japanese translation of Copyright, includes
	original text. Encoding is Shift-JIS.

	* win/README-Windows.txt win/README-Windows-ja.txt: New files, 
	displayed by installer before installation. Based on Tatsuro Matsuoka's
	README.Windows.gpteam and README.

	* config/mingw/Makefile: New make target 'installer'. Let make dist
	copy TeX files to a standard TeX directory structure (TDS).

	* Makefile.am (EXTRA_DIST): Include win/

2011-12-21  Ethan A Merritt  <merritt@u.washington.edu>

	* src/plot2d.c:  The default sequence of histogram colors was one off
	from the default sequence of line colors.  Bugfix.

2011-12-14  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/QtGnuplotScene.cpp src/qtterminal/QtGnuplotSettings.ui
	src/qtterminal/QtGnuplotWidget.cpp src/qtterminal/QtGnuplotWidget.h:
	Support rounded linejoins/caps in qt terminal.

	* src/qtterminal/qt_term.cpp src/qtterminal/qt_term.h term/qt.trm:
	Add term->layer() entry point for qt terminal.

	* src/qtterminal/qt_term.cpp:
	Support for dashed lines in qt terminal.

2011-12-10  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term.c src/wxterminal/wxt_gui.cpp term/svg.trm:
	Allow toggling individual plots on/off inside a multiplot page.
	Bugfix.

2011-12-08  Ethan A Merritt  <merritt@u.washington.edu>

	* docs/gnuplot.doc docs/Makefile.in term/context.trm docs/doc2rnh.c:
	Miscellaneous documentation updates, remove dead URLs.

	* configure.in docs/gnuplot.doc src/plot.c src/show.c
	config/config.cyg config/config.dj2 config/config.mgw config/config.nt
	config/config.os2 config/config.oww config/makefile.unx:

	Despite what it says in the documentation, and despite what the
	configure script prints out, auto-configuration never defined the
	NOCWDRC flag to disable reading an initialization file .gnuplot
	from the current directory.  This is a security risk.  Furthermore,
	having to define something special to get the secure state is bad
	design.  Fix the configuration script and default to not initializing
	from the current directory.  Put a warning in various config files.

2011-12-07  Bastian Maerkisch  <bmaerkisch@web.de>

	* demo/random.dem: Use loops to create random number data sets.

2011-12-06  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/winmain.c src/win/wtext.h config/config.mgw config/config.nt
	config/mingw/Makefile config/msvc/Makefile: Emulation of popen/pclose
	for wgnuplot via temporary files. Briefly opens a console window for
	every pipe and read and write pipes are supported.

2011-12-05  Bastian Maerkisch  <bmaerkisch@web.de>

	* src/win/winmain.c: Automatic language detection can be overridden
	by new setting "Language=XX" in wgnuplot.ini. Suggestion by Shigeharu
	Takeno.

2011-12-03  Ethan A Merritt  <merritt@u.washington.edu>

	* src/gadgets.h src/set.c src/show.c src/graph3d.c src/graphics.c
	src/save.c docs/gnuplot.doc: Add an arrow specification syntax variant
	    "set arrow <tag> from <position> length <val> angle <angle>"
	that makes it easy to describe arrows of constant length, independent of
	terminal or graph aspect ratios and 3D view angle.

2011-12-01  Ethan A Merritt  <merritt@u.washington.edu>

	* src/graph3d.c (draw_3d_graphbox): Rather than treating the position
	of the z-axis label as a fixed 3D [x,y,z], always draw it at a fixed
	distance to the left of the z axis.  This is a CHANGE in behavior.
	Bug #2879916

2011-11-29  Ethan A Merritt  <merritt@u.washington.edu>

	* src/qtterminal/QtGnuplotItems.cpp src/qtterminal/QtGnuplotItems.h
	src/qtterminal/QtGnuplotScene.cpp src/qtterminal/qt_term.cpp
	term/qt.trm configure.in:
	- Pointsize is a double, not an integer (fractional sizes were being
	  truncated to zero).
	- When a polygon is flushed, the final vertex must be kept as the
	  current position. Bug #3370540.
	- The default rendering ("native") is pathetically slow for polygons.
	  If the Qt version is >= 4.7 this can be changed using environmental
	  variable QT_GRAPHICSSYSTEM.  Otherwise we force it to "raster".

2011-11-29  Shigeharu Takeno  <shige@iee.niit.ac.jp>

	* docs/Makefile.in:  Remove duplicate entry for qt in CORETERMS.

2011-11-28  Ethan A Merritt  <merritt@u.washington.edu>

	* src/scanner.c (legal_identifier) src/scanner.h src/stats.c fit.c:
	Make sure that the variable name produced by the "stats ... prefix"
	command is a legal identifier.
	Bug #3441395

	* src/set.c (set_autoscale_axis): Remove unjustifiably large macros.

	* docs/gnuplot.doc src/graph3d.c: Spelling, additional index keywords.

2011-11-26  Bastian Maerkisch  <bmaerkisch@web.de>

	* config/config.nt config/config.mgw: Sync with config.h created by
	autoconf.

	* src/msvc/Makefile: More complete install target. Add new variables
	to hold paths to external libraries.

	src/mingw/Makefile: Include index in gnuplot.pdf.

2011-11-26  Ethan A Merritt  <merritt@u.washington.edu>

	* term/cairo.trm: Revert the change of 2011-08-25 that tried to skip 
	empty vectors. The concept was sound but the implementation was not
	correct, leading to mysteriously missing lines.
	Bugfix.

2011-11-26  Bastian Maerkisch  <bmaerkisch@web.de>

	* config/mingw/Makefile: Support building of the Japanese help file
	wgnuplot-ja.chm.

	* src/win/wpause.c: Remove local definition of TBOOLEAN.

	* docs/plotstyles.gnu: Prefer pngcairo over png terminal. Use font
	"Times New Roman" on Windows.

	* src/syscfg.h: All tested platforms (XP, Vista, 7) support '/' as
	directory separator.

	* src/eval.c (update_gpval_variables): New variable GPVAL_ENCODING.

	* term/gd.trm (gd_iconv): Silence const mismatch compiler warning
	in call to iconv by casting second argument to (void *).

2011-11-25  Ethan A Merritt  <merritt@u.washington.edu>

	* src/setshow.h src/unset.c src/axis.c src/graph3d.c src/plot3d.c
	src/set.c src/term.c: Deal with more FIXMEs.

	* src/axis.c src/axis.h src/mouse.c src/save.c src/set.c src/show.c
	term/canvas.trm term/js/gnuplot_mouse.js term/js/gnuplot_svg.js
	term/svg.trm demo/world.dem docs/gnuplot.doc:

	New coordinate mode for geographic (DMS) data axes. 
	`set xdata geographic` indicates that the x coordinate is to be
	interpreted as a geographic coordinate measured in degrees.
	Use `set format x` to establish how the coordinate appears as an axis
	tick label. Similarly for the y axis.

2011-11-24  Ethan A Merritt  <merritt@u.washington.edu>

	* src/term_api.h src/misc.c src/hidden3d.c:  New flag LT_SINGLECOLOR
	passed through to hidden3d to indicate that the user gave an explicit
	surface color in the splot command.
	Bugfix.

2011-11-22  Ethan A Merritt  <merritt@u.washington.edu>

	* Branchpoint for 4.6 (cvs tag -b branch-4-6-stable)

>>> Earlier entries are in ChangeLog.3
